<popup-page>
  <popup-header slot="header" [pageTitle]="headerText" showBackButton> </popup-header>

  <ng-container *ngIf="!!cipher">
    <app-item-details-v2
      [cipher]="cipher"
      [organization]="organization$ | async"
      [collections]="collections$ | async"
      [folder]="folder$ | async"
    >
    </app-item-details-v2>
  </ng-container>

  <ng-container *ngIf="!!cipher">
    <app-additional-information-v2 [cipher]="cipher"> </app-additional-information-v2>
  </ng-container>

  <!-- ATTACHMENTS SECTION -->
  <div class="tw-mb-6" *ngIf="cipher.attachments">
    <h5 class="tw-pl-2 tw-font-bold tw-text-headers">{{ "attachments" | i18n }}</h5>
    <div class="box-content-row tw-p-2" *ngFor="let attachment of cipher.attachments">
      <div class="tw-flex tw-justify-between">
        <div>
          <h3 class="tw-grow">
            {{ attachment.fileName }}
          </h3>
          <div class="box-footer row-label">
            {{ attachment.sizeName }}
          </div>
        </div>
        <div class="tw-flex tw-items-center">
          <i class="bwi bwi-eye bwi-lg bwi-fw"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- ITEM HISTORY SECTION -->
  <div class="tw-mb-6">
    <h5 class="tw-pl-2 tw-font-bold tw-text-headers">{{ "itemHistory" | i18n }}</h5>
    <div class="box-content-row">
      <p class="row-label">
        <span class="tw-font-bold">{{ "lastEdited" | i18n }}:</span>
        {{ cipher.revisionDate | date: "medium" }}
      </p>
      <p class="row-label">
        <span class="tw-font-bold">{{ "dateCreated" | i18n }}:</span>
        {{ cipher.creationDate | date: "medium" }}
      </p>
      <p class="row-label">
        <span class="tw-font-bold">{{ "datePasswordUpdated" | i18n }}:</span>
        {{ cipher.passwordRevisionDisplayDate | date: "medium" }}
      </p>
      <div *ngIf="cipher.hasPasswordHistory">
        <a (click)="openPasswordHistory()">{{ "passwordHistory" | i18n }}</a>
      </div>
    </div>
  </div>

  <popup-footer slot="footer">
    <a bitButton type="button" buttonType="primary" (click)="editCipher()">
      {{ "edit" | i18n }}
    </a>

    <ng-container slot="end">
      <button
        type="button"
        class="box-content-row"
        (click)="deleteCipher()"
        appStopClick
        #deleteBtn
      >
        <div class="row-main text-danger">
          <div class="icon text-danger" aria-hidden="true">
            <i class="bwi bwi-trash bwi-lg bwi-fw"></i>
          </div>
        </div>
      </button>
    </ng-container>
  </popup-footer>
</popup-page>
