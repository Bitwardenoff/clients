"use strict";(self.webpackChunk_bitwarden_web_vault=self.webpackChunk_bitwarden_web_vault||[]).push([[290],{94107:(e,t,s)=>{s.d(t,{Y:()=>H});var i,r=s(24852),n=s(98645),o=s(54019),a=s(62324),l=s(68362),c=s(53634);!function(e){e[e.AccountEncrypted=0]="AccountEncrypted",e[e.FileEncrypted=1]="FileEncrypted"}(i||(i={}));var u=s(70291),p=s(3650),h=s(92785),d=s(94820),m=s(32100),f=s(14424),g=s(65332),y=s(1593),v=s(27885),w=s(64751),O=s(86290),x=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{l(i.next(e))}catch(t){n(t)}}function a(e){try{l(i.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class N{constructor(e,t,s,a,l,c,u,p,h,d,m){this.cryptoService=e,this.i18nService=t,this.platformUtilsService=s,this.exportService=a,this.eventService=l,this.policyService=c,this.win=u,this.logService=p,this.userVerificationService=h,this.formBuilder=d,this.fileDownloadService=m,this.onSaved=new r.vpe,this.disabledByPolicy=!1,this.exportForm=this.formBuilder.group({format:["json"],secret:[""],filePassword:["",n.kI.required],confirmFilePassword:["",n.kI.required],fileEncryptionType:[i.AccountEncrypted]}),this.formatOptions=[{name:".json",value:"json"},{name:".csv",value:"csv"},{name:".json (Encrypted)",value:"encrypted_json"}],this.destroy$=new o.x}ngOnInit(){return x(this,void 0,void 0,(function*(){yield this.checkExportDisabled(),(0,a.T)(this.exportForm.get("format").valueChanges,this.exportForm.get("fileEncryptionType").valueChanges).pipe((0,l.R)(this.destroy$)).pipe((0,c.O)(0)).subscribe((()=>this.adjustValidators()))}))}ngOnDestroy(){this.destroy$.next()}checkExportDisabled(){return x(this,void 0,void 0,(function*(){this.disabledByPolicy=yield this.policyService.policyAppliesToUser(p.M.DisablePersonalVaultExport),this.disabledByPolicy&&this.exportForm.disable()}))}get encryptedFormat(){return"encrypted_json"===this.format}doExport(){return x(this,void 0,void 0,(function*(){try{this.formPromise=this.getExportData();const e=yield this.formPromise;this.downloadFile(e),this.saved(),yield this.collectEvent(),this.exportForm.get("secret").setValue(""),this.exportForm.clearValidators()}catch(e){this.logService.error(e)}}))}submit(){return x(this,void 0,void 0,(function*(){if(this.disabledByPolicy)return void this.platformUtilsService.showToast("error",null,this.i18nService.t("personalVaultExportPolicyInEffect"));if(!(yield this.warningDialog()))return;const e=this.exportForm.get("secret").value;try{yield this.userVerificationService.verifyUser(e)}catch(t){return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),t.message)}this.doExport()}))}warningDialog(){return x(this,void 0,void 0,(function*(){return this.encryptedFormat?yield this.platformUtilsService.showDialog("<p>"+this.i18nService.t("encExportKeyWarningDesc")+"<p>"+this.i18nService.t("encExportAccountWarningDesc"),this.i18nService.t("confirmVaultExport"),this.i18nService.t("exportVault"),this.i18nService.t("cancel"),"warning",!0):yield this.platformUtilsService.showDialog(this.i18nService.t("exportWarningDesc"),this.i18nService.t("confirmVaultExport"),this.i18nService.t("exportVault"),this.i18nService.t("cancel"),"warning")}))}saved(){this.onSaved.emit()}getExportData(){return"encrypted_json"===this.format&&this.fileEncryptionType===i.FileEncrypted?this.exportService.getPasswordProtectedExport(this.filePassword):this.exportService.getExport(this.format,null)}getFileName(e){let t=this.format;return"encrypted_json"===this.format&&(e=null==e?"encrypted":"encrypted_"+e,t="json"),this.exportService.getFileName(e,t)}collectEvent(){return x(this,void 0,void 0,(function*(){yield this.eventService.collect(u.t.User_ClientExportedVault)}))}get format(){return this.exportForm.get("format").value}get filePassword(){return this.exportForm.get("filePassword").value}get confirmFilePassword(){return this.exportForm.get("confirmFilePassword").value}get fileEncryptionType(){return this.exportForm.get("fileEncryptionType").value}toggleFilePassword(){this.showFilePassword=!this.showFilePassword,document.getElementById("filePassword").focus()}toggleConfirmFilePassword(){this.showConfirmFilePassword=!this.showConfirmFilePassword,document.getElementById("confirmFilePassword").focus()}adjustValidators(){this.exportForm.get("confirmFilePassword").reset(),this.exportForm.get("filePassword").reset(),this.encryptedFormat&&this.fileEncryptionType==i.FileEncrypted?(this.exportForm.controls.filePassword.enable(),this.exportForm.controls.confirmFilePassword.enable()):(this.exportForm.controls.filePassword.disable(),this.exportForm.controls.confirmFilePassword.disable())}downloadFile(e){const t=this.getFileName();this.fileDownloadService.download({fileName:t,blobData:e,blobOptions:{type:"text/plain"}})}}N.ɵfac=function(e){return new(e||N)(r.Y36(h.$),r.Y36(d.D),r.Y36(m.P),r.Y36(f.T),r.Y36(g.P),r.Y36(y.d),r.Y36(Window),r.Y36(v.$),r.Y36(w.i),r.Y36(n.QS),r.Y36(O._))},N.ɵdir=r.lG2({type:N,outputs:{onSaved:"onSaved"}});var C=s(77494),b=s(56965),U=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{l(i.next(e))}catch(t){n(t)}}function a(e){try{l(i.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class _{constructor(e,t,s,i,r,o){this.modalRef=e,this.config=t,this.userVerificationService=s,this.formBuilder=i,this.platformUtilsService=r,this.i18nService=o,this.confirmDescription=this.config.data.confirmDescription,this.confirmButtonText=this.config.data.confirmButtonText,this.modalTitle=this.config.data.modalTitle,this.secret=new n.NI}submit(){return U(this,void 0,void 0,(function*(){try{yield this.userVerificationService.verifyUser(this.secret.value)}catch(e){return void this.platformUtilsService.showToast("error",this.i18nService.t("error"),this.i18nService.t("invalidMasterPassword"))}this.modalRef.close(!0)}))}}_.ɵfac=function(e){return new(e||_)(r.Y36(b.b),r.Y36(C.u),r.Y36(w.i),r.Y36(n.qu),r.Y36(m.P),r.Y36(d.D))},_.ɵdir=r.lG2({type:_});var D=s(81974),P=s(73484),V=s(19419),S=s(17404);class k extends _{}k.ɵfac=function(){let e;return function(t){return(e||(e=r.n5z(k)))(t||k)}}(),k.ɵcmp=r.Xpm({type:k,selectors:[["ng-component"]],features:[r.qOj],decls:39,vars:15,consts:[["role","dialog","aria-modal","true","aria-labelledby","confirmUserTitle",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-scrollable"],[1,"modal-content",3,"ngSubmit"],["form",""],["id","modalTitle | i18n ",1,"tw-mt-6","tw-mb-6","tw-pl-3.5","tw-pr-3.5","tw-font-semibold"],[1,"tw-border-0","tw-border-t","tw-border-solid","tw-border-secondary-300","tw-p-3.5"],[1,"tw-p-3.5"],["ngDefaultControl","","name","secret",3,"formControl"],[1,"tw-border-0","tw-border-t","tw-border-solid","tw-border-secondary-300","tw-bg-background-alt","tw-p-3.5"],["bitButton","","buttonType","primary","type","submit","appBlurClick",""],["bitButton","","buttonType","secondary","data-dismiss","modal"]],template:function(e,t){1&e&&(r.TgZ(0,"div",0),r._uU(1,"\n  "),r.TgZ(2,"div",1),r._uU(3,"\n    "),r.TgZ(4,"form",2,3),r.NdJ("ngSubmit",(function(){return t.submit()})),r._uU(6,"\n      "),r.TgZ(7,"h2",4),r._uU(8),r.ALo(9,"uppercase"),r.ALo(10,"i18n"),r.qZA(),r._uU(11,"\n      "),r.TgZ(12,"div",5),r._uU(13),r.ALo(14,"i18n"),r.qZA(),r._uU(15,"\n      "),r.TgZ(16,"div",6),r._uU(17,"\n        "),r.TgZ(18,"app-user-verification",7),r._uU(19,"\n        "),r.qZA(),r._uU(20,"\n      "),r.qZA(),r._uU(21,"\n      "),r.TgZ(22,"div",8),r._uU(23,"\n        "),r.TgZ(24,"button",9),r._uU(25,"\n          "),r.TgZ(26,"span"),r._uU(27),r.ALo(28,"i18n"),r.qZA(),r._uU(29,"\n        "),r.qZA(),r._uU(30,"\n        "),r.TgZ(31,"button",10),r._uU(32),r.ALo(33,"i18n"),r.qZA(),r._uU(34,"\n      "),r.qZA(),r._uU(35,"\n    "),r.qZA(),r._uU(36,"\n  "),r.qZA(),r._uU(37,"\n"),r.qZA(),r._uU(38,"\n")),2&e&&(r.xp6(8),r.hij("\n        ",r.lcZ(9,5,r.lcZ(10,7,t.modalTitle)),"\n      "),r.xp6(5),r.hij("\n        ",r.lcZ(14,9,t.confirmDescription),"\n      "),r.xp6(5),r.Q6J("formControl",t.secret),r.xp6(9),r.Oqu(r.lcZ(28,11,t.confirmButtonText)),r.xp6(5),r.hij("\n          ",r.lcZ(33,13,"cancel"),"\n        "))},dependencies:[n._Y,n.Fj,n.JJ,n.JL,n.F,n.oH,D.r,P.W,V.gd,S.C],encapsulation:2});var E=s(33245),A=s(24610),T=s(25376),I=s(53707),F=s(70919),L=s(2051),W=s(24637),Z=s(11512),q=s(10083),B=s(1e4),R=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{l(i.next(e))}catch(t){n(t)}}function a(e){try{l(i.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};function M(e,t){1&e&&(r.TgZ(0,"app-callout",15),r.ALo(1,"i18n"),r._uU(2),r.ALo(3,"i18n"),r.qZA()),2&e&&(r.s9C("title",r.lcZ(1,2,"vaultExportDisabled")),r.xp6(2),r.hij("\n    ",r.lcZ(3,4,"personalVaultExportPolicyInEffect"),"\n  "))}function Y(e,t){if(1&e&&r._UZ(0,"app-export-scope-callout",16),2&e){const e=r.oxw(2);r.Q6J("organizationId",e.organizationId)}}function Q(e,t){if(1&e&&(r.TgZ(0,"option",17),r._uU(1),r.qZA()),2&e){const e=t.$implicit;r.Q6J("value",e.value),r.xp6(1),r.Oqu(e.name)}}const J=function(e,t){return{"bwi-eye":e,"bwi-eye-slash":t}};function z(e,t){if(1&e){const e=r.EpF();r.ynx(0),r._uU(1,"\n          "),r.TgZ(2,"div",28),r._uU(3,"\n            "),r.TgZ(4,"bit-form-field",29),r._uU(5,"\n              "),r.TgZ(6,"bit-label"),r._uU(7),r.ALo(8,"i18n"),r.qZA(),r._uU(9,"\n              "),r._UZ(10,"input",30),r._uU(11,"\n\n              "),r.TgZ(12,"div",31),r._uU(13,"\n                "),r.TgZ(14,"button",32),r.NdJ("click",(function(){r.CHM(e);const t=r.oxw(3);return r.KtG(t.toggleFilePassword())})),r.ALo(15,"i18n"),r._uU(16,"\n                  "),r._UZ(17,"i",33),r._uU(18,"\n                "),r.qZA(),r._uU(19,"\n              "),r.qZA(),r._uU(20,"\n            "),r.qZA(),r._uU(21,"\n            "),r.TgZ(22,"div",34),r._uU(23),r.ALo(24,"i18n"),r.qZA(),r._uU(25,"\n          "),r.qZA(),r._uU(26,"\n          "),r.TgZ(27,"div",35),r._uU(28,"\n            "),r.TgZ(29,"bit-form-field",29),r._uU(30,"\n              "),r.TgZ(31,"bit-label"),r._uU(32),r.ALo(33,"i18n"),r.qZA(),r._uU(34,"\n              "),r._UZ(35,"input",36),r._uU(36,"\n              "),r.TgZ(37,"div",31),r._uU(38,"\n                "),r.TgZ(39,"button",32),r.NdJ("click",(function(){r.CHM(e);const t=r.oxw(3);return r.KtG(t.toggleConfirmFilePassword())})),r.ALo(40,"i18n"),r._uU(41,"\n                  "),r._UZ(42,"i",33),r._uU(43,"\n                "),r.qZA(),r._uU(44,"\n              "),r.qZA(),r._uU(45,"\n            "),r.qZA(),r._uU(46,"\n          "),r.qZA(),r._uU(47,"\n        "),r.BQk()}if(2&e){const e=r.oxw(3);r.xp6(7),r.Oqu(r.lcZ(8,11,"filePassword")),r.xp6(3),r.s9C("type",e.showFilePassword?"text":"password"),r.xp6(4),r.s9C("appA11yTitle",r.lcZ(15,13,"toggleVisibility")),r.uIk("aria-pressed",e.showFilePassword),r.xp6(3),r.Q6J("ngClass",r.WLB(21,J,!e.showFilePassword,e.showFilePassword)),r.xp6(6),r.hij("\n              ",r.lcZ(24,15,"exportPasswordDescription"),"\n            "),r.xp6(9),r.Oqu(r.lcZ(33,17,"confirmFilePassword")),r.xp6(3),r.s9C("type",e.showConfirmFilePassword?"text":"password"),r.xp6(4),r.s9C("appA11yTitle",r.lcZ(40,19,"toggleVisibility")),r.uIk("aria-pressed",e.showConfirmFilePassword),r.xp6(3),r.Q6J("ngClass",r.WLB(24,J,!e.showConfirmFilePassword,e.showConfirmFilePassword))}}function j(e,t){if(1&e&&(r.ynx(0),r._uU(1,"\n        "),r.TgZ(2,"div",18),r._uU(3,"\n          "),r.TgZ(4,"label",19),r._uU(5),r.ALo(6,"i18n"),r.qZA(),r._uU(7,"\n\n          "),r.TgZ(8,"div",20),r._uU(9,"\n            "),r.TgZ(10,"div"),r._uU(11,"\n              "),r._UZ(12,"input",21),r._uU(13,"\n            "),r.qZA(),r._uU(14,"\n            "),r.TgZ(15,"div"),r._uU(16,"\n              "),r.TgZ(17,"label",22),r._uU(18),r.ALo(19,"i18n"),r.qZA(),r._uU(20,"\n            "),r.qZA(),r._uU(21,"\n          "),r.qZA(),r._uU(22,"\n\n          "),r.TgZ(23,"div",23),r._uU(24),r.ALo(25,"i18n"),r.qZA(),r._uU(26,"\n\n          "),r.TgZ(27,"div",24),r._uU(28,"\n            "),r.TgZ(29,"div"),r._uU(30,"\n              "),r._UZ(31,"input",25),r._uU(32,"\n            "),r.qZA(),r._uU(33,"\n            "),r.TgZ(34,"div"),r._uU(35,"\n              "),r.TgZ(36,"label",26),r._uU(37),r.ALo(38,"i18n"),r.qZA(),r._uU(39,"\n            "),r.qZA(),r._uU(40,"\n          "),r.qZA(),r._uU(41,"\n\n          "),r.TgZ(42,"div",27),r._uU(43),r.ALo(44,"i18n"),r.qZA(),r._uU(45,"\n        "),r.qZA(),r._uU(46,"\n        "),r._UZ(47,"br"),r._uU(48,"\n\n        "),r.YNc(49,z,48,27,"ng-container",12),r._uU(50,"\n      "),r.BQk()),2&e){const e=r.oxw(2);r.xp6(5),r.hij("\n            ",r.lcZ(6,10,"fileTypeHeading"),"\n          "),r.xp6(7),r.Q6J("value",e.encryptedExportType.AccountEncrypted)("checked",e.fileEncryptionType===e.encryptedExportType.AccountEncrypted),r.xp6(6),r.hij("\n                ",r.lcZ(19,12,"accountBackup"),"\n              "),r.xp6(6),r.hij("\n            ",r.lcZ(25,14,"accountBackupOptionDescription"),"\n          "),r.xp6(7),r.Q6J("value",e.encryptedExportType.FileEncrypted)("checked",e.fileEncryptionType===e.encryptedExportType.FileEncrypted),r.xp6(6),r.Oqu(r.lcZ(38,16,"passwordProtected")),r.xp6(6),r.hij("\n            ",r.lcZ(44,18,"passwordProtectedOptionDescription"),"\n          "),r.xp6(6),r.Q6J("ngIf",e.fileEncryptionType==e.encryptedExportType.FileEncrypted)}}function K(e,t){if(1&e){const e=r.EpF();r.TgZ(0,"form",1,2),r.NdJ("ngSubmit",(function(){r.CHM(e);const t=r.oxw();return r.KtG(t.submit())})),r._uU(2,"\n  "),r.TgZ(3,"div",3),r._uU(4,"\n    "),r.TgZ(5,"h1"),r._uU(6),r.ALo(7,"i18n"),r.qZA(),r._uU(8,"\n  "),r.qZA(),r._uU(9,"\n\n  "),r.YNc(10,M,4,6,"app-callout",4),r._uU(11,"\n  "),r.YNc(12,Y,1,1,"app-export-scope-callout",5),r._uU(13,"\n\n  "),r.TgZ(14,"div",6),r._uU(15,"\n    "),r.TgZ(16,"div",7),r._uU(17,"\n      "),r.TgZ(18,"bit-form-field"),r._uU(19,"\n        "),r.TgZ(20,"bit-label",8),r._uU(21),r.ALo(22,"i18n"),r.qZA(),r._uU(23,"\n        "),r.TgZ(24,"select",9),r._uU(25,"\n          "),r.YNc(26,Q,2,2,"option",10),r._uU(27,"\n        "),r.qZA(),r._uU(28,"\n      "),r.qZA(),r._uU(29,"\n    "),r.qZA(),r._uU(30,"\n  "),r.qZA(),r._uU(31,"\n  "),r.TgZ(32,"div",6),r._uU(33,"\n    "),r.TgZ(34,"div",11),r._uU(35,"\n      "),r.YNc(36,j,51,20,"ng-container",12),r._uU(37,"\n\n      "),r.TgZ(38,"button",13),r._uU(39,"\n        "),r._UZ(40,"i",14),r.ALo(41,"i18n"),r._uU(42,"\n        "),r.TgZ(43,"span"),r._uU(44),r.ALo(45,"i18n"),r.qZA(),r._uU(46,"\n      "),r.qZA(),r._uU(47,"\n    "),r.qZA(),r._uU(48,"\n  "),r.qZA(),r._uU(49,"\n"),r.qZA()}if(2&e){const e=r.MAs(1),t=r.oxw();r.Q6J("appApiAction",t.formPromise)("formGroup",t.exportForm),r.xp6(6),r.Oqu(r.lcZ(7,11,"exportVault")),r.xp6(4),r.Q6J("ngIf",t.disabledByPolicy),r.xp6(2),r.Q6J("ngIf",!t.disabledByPolicy),r.xp6(9),r.Oqu(r.lcZ(22,13,"fileFormat")),r.xp6(5),r.Q6J("ngForOf",t.formatOptions),r.xp6(10),r.Q6J("ngIf","encrypted_json"===t.format),r.xp6(2),r.Q6J("disabled",e.loading||t.disabled),r.xp6(2),r.s9C("title",r.lcZ(41,15,"loading")),r.xp6(4),r.Oqu(r.lcZ(45,17,"confirmFormat"))}}class H extends N{constructor(e,t,s,r,n,o,a,l,c,u,p){super(e,t,s,r,n,o,window,a,l,c,u),this.modalService=p,this.encryptedExportType=i}submit(){return R(this,void 0,void 0,(function*(){if(this.isFileEncryptedExport&&this.filePassword!=this.confirmFilePassword)return void this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("filePasswordAndConfirmFilePasswordDoNotMatch"));if(this.exportForm.markAllAsTouched(),!this.exportForm.valid)return;if(this.disabledByPolicy)return void this.platformUtilsService.showToast("error",null,this.i18nService.t("personalVaultExportPolicyInEffect"));(yield this.verifyUser())&&this.doExport()}))}saved(){super.saved(),this.platformUtilsService.showToast("success",null,this.i18nService.t("exportSuccess"))}verifyUser(){let e="exportWarningDesc";this.isFileEncryptedExport?e="fileEncryptedExportWarningDesc":this.isAccountEncryptedExport&&(e="encExportKeyWarningDesc");const t=this.modalService.open(k,{allowMultipleModals:!0,data:{confirmDescription:e,confirmButtonText:"exportVault",modalTitle:"confirmVaultExport"}});if(null!=t)return t.onClosedPromise()}get isFileEncryptedExport(){return"encrypted_json"===this.format&&this.fileEncryptionType===i.FileEncrypted}get isAccountEncryptedExport(){return"encrypted_json"===this.format&&this.fileEncryptionType===i.AccountEncrypted}}H.ɵfac=function(e){return new(e||H)(r.Y36(h.$),r.Y36(d.D),r.Y36(m.P),r.Y36(f.T),r.Y36(g.P),r.Y36(y.d),r.Y36(v.$),r.Y36(w.i),r.Y36(n.QS),r.Y36(O._),r.Y36(C.Z))},H.ɵcmp=r.Xpm({type:H,selectors:[["app-export"]],features:[r.qOj],decls:2,vars:1,consts:[[3,"appApiAction","formGroup","ngSubmit",4,"ngIf"],[3,"appApiAction","formGroup","ngSubmit"],["form",""],[1,"page-header"],["type","error",3,"title",4,"ngIf"],[3,"organizationId",4,"ngIf"],[1,"row"],[1,"col-6"],["for","format",1,"tw-text-lg"],["bitInput","","name","format","formControlName","format"],[3,"value",4,"ngFor","ngForOf"],[1,"form-group","col-6"],[4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-submit",3,"disabled"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin",3,"title"],["type","error",3,"title"],[3,"organizationId"],[3,"value"],["role","radiogroup","aria-labelledby","fileTypeHeading"],["id","fileTypeHeading",1,"tw-semi-bold","tw-text-lg"],["appBoxRow","","name","FileTypeOptions",1,"tw-flex","tw-items-center"],["type","radio","name","fileEncryptionType","id","AccountEncrypted","formControlName","fileEncryptionType",1,"radio",3,"value","checked"],["for","AccountEncrypted",1,"tw-semi-bold","tw-text-md","tw-ml-1","tw-mt-1","tw-mb-1"],[1,"tw-regular","ml-3","pb-2","tw-text-sm"],[1,"tw-flex","tw-items-center"],["type","radio","name","fileEncryptionType","id","FileEncrypted","formControlName","fileEncryptionType",1,"radio",3,"value","checked"],["for","FileEncrypted",1,"tw-semi-bold","tw-text-md","tw-ml-1","tw-mt-1","tw-mb-1"],[1,"tw-regular","ml-3","tw-text-sm"],[1,"input-group"],[1,"tw-w-full"],["bitInput","","id","filePassword","formControlName","filePassword","name","password",3,"type"],[1,"input-group-append"],["bitSuffix","","bitButton","","buttonType","secondary","appStopClick","","type","button",3,"appA11yTitle","click"],["aria-hidden","true",1,"bwi","bwi-lg",3,"ngClass"],[1,"small","text-muted"],[1,"input-group","tw-mt-4"],["bitInput","","id","confirmFilePassword","formControlName","confirmFilePassword","name","confirmFilePassword",3,"type"]],template:function(e,t){1&e&&(r.YNc(0,K,50,19,"form",0),r._uU(1,"\n")),2&e&&r.Q6J("ngIf",t.exportForm)},dependencies:[V.mk,V.sg,V.O5,n._Y,n.YN,n.Kr,n.Fj,n.EJ,n._,n.JJ,n.JL,E.B,A.b,T.$,I.O,F.N,L.O,n.sg,n.u,D.r,W.d,Z.G,q.u,B.e,S.C],encapsulation:2})},18058:(e,t,s)=>{s.d(t,{k:()=>Le});var i=s(48584),r=s(8835),n=s.n(r),o=s(77494),a=s(3650),l=s(98645),c=s(24852),u=s(56965),p=s(19419),h=s(33245),d=s(62374),m=s(85356),f=s(2051),g=s(81974),y=s(24637),v=s(11512),w=s(10083),O=s(1e4),x=s(17404);const N=function(e,t){return{"bwi-eye":e,"bwi-eye-slash":t}};class C{constructor(e){this.modalRef=e,this.filePassword=new l.NI("",l.kI.required)}toggleFilePassword(){this.showFilePassword=!this.showFilePassword}submit(){this.filePassword.markAsTouched(),this.filePassword.valid&&this.modalRef.close(this.filePassword.value)}cancel(){this.modalRef.close(null)}}C.ɵfac=function(e){return new(e||C)(c.Y36(u.b))},C.ɵcmp=c.Xpm({type:C,selectors:[["ng-component"]],decls:55,vars:30,consts:[["role","dialog","aria-modal","true",1,"modal","fade"],["role","document",1,"modal-dialog","modal-dialog-scrollable"],[3,"ngSubmit"],["form",""],[1,"form-group","modal-content"],["id","confirmVaultImport",1,"tw-mt-6","tw-mb-6","tw-ml-3.5","tw-font-semibold"],[1,"tw-border-0","tw-border-t","tw-border-solid","tw-border-secondary-300","tw-pr-3.5","tw-pt-3.5","tw-pl-3.5"],[1,"tw-w-full","tw-pt-3.5"],["bitInput","","required","","name","filePassword","appAutofocus","","appInputVerbatim","",3,"type","formControl"],["bitSuffix","","bitButton","","appStopClick","","type","button",3,"appA11yTitle","click"],["aria-hidden","true",1,"bwi","bwi-lg",3,"ngClass"],[1,"tw-flex","tw-w-full","tw-flex-wrap","tw-items-center","tw-border-0","tw-border-t","tw-border-solid","tw-border-secondary-300","tw-bg-background-alt","tw-pl-3.5","tw-pr-3.5","tw-pb-3.5","tw-pt-4","tw-pl-4","tw-pr-4"],["bitButton","","buttonType","primary","type","submit","appBlurClick","",1,"tw-mr-2"],["bitButton","","buttonType","secondary","type","button",3,"click"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c.ALo(1,"i18n"),c._uU(2,"\n  "),c.TgZ(3,"div",1),c._uU(4,"\n    "),c.TgZ(5,"form",2,3),c.NdJ("ngSubmit",(function(){return t.submit()})),c._uU(7,"\n      "),c.TgZ(8,"div",4),c._uU(9,"\n        "),c.TgZ(10,"h2",5),c._uU(11),c.ALo(12,"uppercase"),c.ALo(13,"i18n"),c.qZA(),c._uU(14,"\n        "),c.TgZ(15,"div",6),c._uU(16),c.ALo(17,"i18n"),c.TgZ(18,"bit-form-field",7),c._uU(19,"\n            "),c.TgZ(20,"bit-label"),c._uU(21),c.ALo(22,"i18n"),c.qZA(),c._uU(23,"\n            "),c._UZ(24,"input",8),c._uU(25,"\n            "),c.TgZ(26,"button",9),c.NdJ("click",(function(){return t.toggleFilePassword()})),c.ALo(27,"i18n"),c._uU(28,"\n              "),c._UZ(29,"i",10),c._uU(30,"\n            "),c.qZA(),c._uU(31,"\n          "),c.qZA(),c._uU(32,"\n        "),c.qZA(),c._uU(33,"\n        "),c.TgZ(34,"div",11),c._uU(35,"\n          "),c.TgZ(36,"button",12),c._uU(37,"\n            "),c.TgZ(38,"span"),c._uU(39),c.ALo(40,"i18n"),c.qZA(),c._uU(41,"\n          "),c.qZA(),c._uU(42,"\n          "),c.TgZ(43,"button",13),c.NdJ("click",(function(){return t.cancel()})),c._uU(44,"\n            "),c.TgZ(45,"span"),c._uU(46),c.ALo(47,"i18n"),c.qZA(),c._uU(48,"\n          "),c.qZA(),c._uU(49,"\n        "),c.qZA(),c._uU(50,"\n      "),c.qZA(),c._uU(51,"\n    "),c.qZA(),c._uU(52,"\n  "),c.qZA(),c._uU(53,"\n"),c.qZA(),c._uU(54,"\n")),2&e&&(c.uIk("aria-labelledby",c.lcZ(1,11,"confirmVaultImport")),c.xp6(11),c.hij("\n          ",c.lcZ(12,13,c.lcZ(13,15,"confirmVaultImport")),"\n        "),c.xp6(5),c.hij("\n          ",c.lcZ(17,17,"confirmVaultImportDesc"),"\n          "),c.xp6(5),c.Oqu(c.lcZ(22,19,"confirmFilePassword")),c.xp6(3),c.s9C("type",t.showFilePassword?"text":"password"),c.Q6J("formControl",t.filePassword),c.xp6(2),c.s9C("appA11yTitle",c.lcZ(27,21,"toggleVisibility")),c.uIk("aria-pressed",t.showFilePassword),c.xp6(3),c.Q6J("ngClass",c.WLB(27,N,!t.showFilePassword,t.showFilePassword)),c.xp6(10),c.Oqu(c.lcZ(40,23,"importData")),c.xp6(7),c.Oqu(c.lcZ(47,25,"cancel")))},dependencies:[p.mk,l._Y,l.Fj,l.JJ,l.JL,l.Q7,l.F,h.B,d.U,m.b,f.O,l.oH,g.r,y.d,v.G,w.u,O.e,p.gd,x.C],encapsulation:2});var b=s(94820),U=s(2798),_=s(15061),D=s(32100),P=s(1593),V=s(27885),S=s(53707),k=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{l(i.next(e))}catch(t){n(t)}}function a(e){try{l(i.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};function E(e,t){1&e&&(c.TgZ(0,"app-callout",18),c._uU(1),c.ALo(2,"i18n"),c.qZA()),2&e&&(c.xp6(1),c.hij("\n  ",c.lcZ(2,1,"personalOwnershipPolicyInEffectImports"),"\n"))}function A(e,t){if(1&e&&(c.TgZ(0,"option",19),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("ngValue",e.id),c.xp6(1),c.Oqu(e.name)}}function T(e,t){if(1&e&&(c.TgZ(0,"option",19),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.Q6J("ngValue",e.id),c.xp6(1),c.Oqu(e.name)}}function I(e,t){if(1&e&&(c.ynx(0),c._uU(1,"\n            "),c._UZ(2,"option",20),c._uU(3,"\n            "),c.YNc(4,T,2,2,"option",9),c._uU(5,"\n          "),c.BQk()),2&e){const e=c.oxw();c.xp6(4),c.Q6J("ngForOf",e.importOptions)}}function F(e,t){1&e&&(c.ynx(0),c._uU(1,"\n      See detailed instructions on our help site at\n      "),c.TgZ(2,"a",22),c._uU(3,"\n        https://bitwarden.com/help/export-your-data/"),c.qZA(),c._uU(4,"\n    "),c.BQk())}function L(e,t){1&e&&(c.ynx(0),c._uU(1,"\n      See detailed instructions on our help site at\n      "),c.TgZ(2,"a",23),c._uU(3,"\n        https://bitwarden.com/help/import-from-lastpass/"),c.qZA(),c._uU(4,"\n    "),c.BQk())}function W(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the KeePassX desktop application, navigate to "Database" → "Export to CSV file" and\n      save the CSV file.\n    '),c.BQk())}function Z(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      In the Avira web vault, go to "Settings" → "My Data" → "Export data" and save the\n      CSV file.\n    '),c.BQk())}function q(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      In the Blur web vault, click your username at the top and go to "Settings" → "Export\n      Data", then click "Export CSV" for your "Accounts".\n    '),c.BQk())}function B(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the SaveInCloud desktop application, navigate to "File" → "Export" → "As XML"\n      and save the XML file.\n    '),c.BQk())}function R(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Padlock desktop application, click the hamburger icon in the top left corner and\n      navigate to "Settings" → "Export" button and save the file "As CSV".\n    '),c.BQk())}function M(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the KeePass 2 desktop application, navigate to "File" → "Export" and select the\n      "KeePass XML (2.x)" option.\n    '),c.BQk())}function Y(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Universal Password Manager desktop application, navigate to "Database" →\n      "Export" and save the CSV file.\n    '),c.BQk())}function Q(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the SaferPass browser extension, click the hamburger icon in the top left corner and\n      navigate to "Settings". Click the "Export accounts" button to save the CSV file.\n    '),c.BQk())}function J(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Meldium web vault, navigate to "Settings". Locate the "Export data" function and\n      click "Show me my data" to save the CSV file.\n    '),c.BQk())}function z(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Log into the Keeper web vault (keepersecurity.com/vault). Click on your "account email" (top\n      right) and select "Settings". Go to "Export" and find the "Export to .csv File" option. Click\n      "Export" to save the CSV file.\n    '),c.BQk())}function j(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Log into the Keeper web vault (keepersecurity.com/vault). Click on your "account email" (top\n      right) and select "Settings". Go to "Export" and find the "Export to .json File" option. Click\n      "Export" to save the JSON file.\n    '),c.BQk())}function K(e,t){1&e&&(c.TgZ(0,"span"),c._uU(1,"\n        The process is exactly the same as importing from Google Chrome.\n      "),c.qZA())}function H(e,t){if(1&e&&(c.ynx(0),c._uU(1,"\n      "),c.YNc(2,K,2,0,"span",10),c._uU(3,"\n      See detailed instructions on our help site at\n      "),c.TgZ(4,"a",24),c._uU(5,"\n        https://bitwarden.com/help/import-from-chrome/"),c.qZA(),c._uU(6,"\n    "),c.BQk()),2&e){const e=c.oxw(2);c.xp6(2),c.Q6J("ngIf","chromecsv"!==e.format)}}function G(e,t){1&e&&(c.ynx(0),c._uU(1,"\n      See detailed instructions on our help site at\n      "),c.TgZ(2,"a",25),c._uU(3,"\n        https://bitwarden.com/help/import-from-firefox/"),c.qZA(),c._uU(4,".\n    "),c.BQk())}function $(e,t){1&e&&(c.ynx(0),c._uU(1,"\n      See detailed instructions on our help site at\n      "),c.TgZ(2,"a",26),c._uU(3,"\n        https://bitwarden.com/help/import-from-safari/"),c.qZA(),c._uU(4,".\n    "),c.BQk())}function X(e,t){1&e&&(c.ynx(0),c._uU(1,"\n      See detailed instructions on our help site at\n      "),c.TgZ(2,"a",27),c._uU(3,"\n        https://bitwarden.com/help/import-from-1password/"),c.qZA(),c._uU(4,".\n    "),c.BQk())}function ee(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Password Dragon desktop application, navigate to "File" → "Export" → "To\n      XML". In the dialog that pops up select "All Rows" and check all fields. Click the "Export"\n      button and save the XML file.\n    '),c.BQk())}function te(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Enpass desktop application, navigate to "File" → "Export" → "As CSV".\n      Select "OK" to the warning alert and save the CSV file. Note that the importer only supports\n      files exported while Enpass is set to the English language, so adjust your settings\n      accordingly.\n    '),c.BQk())}function se(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Enpass 6 desktop application, click the menu button and navigate to "File" →\n      "Export". Select the ".json" file format option and save the JSON file.\n    '),c.BQk())}function ie(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Password Safe desktop application, navigate to "File" → "Export To" → "XML\n      format..." and save the XML file.\n    '),c.BQk())}function re(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Log in to Dashlane, click on "My Account" → "Settings" → "Export file" and select\n      "Export as a CSV file". This will download a zip archive containing various CSV files. Unzip\n      the archive and import each CSV file individually.\n    '),c.BQk())}function ne(e,t){1&e&&(c.ynx(0),c._uU(1,"\n      Dashlane no longer supports the JSON format. Only use this if you have an existing JSON for\n      import. Use the CSV importer when creating new exports.\n    "),c.BQk())}function oe(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the mSecure desktop application, navigate to "File" → "Export" → "CSV File..."\n      and save the CSV file.\n    '),c.BQk())}function ae(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Sticky Password desktop application, navigate to "Menu" (top right) → "Export"\n      → "Export all". Select the unencrypted format XML option and save the XML file.\n    '),c.BQk())}function le(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the True Key desktop application, click the gear icon (top right) and then navigate to\n      "App Settings". Click the "Export" button, enter your password and save the CSV file.\n    '),c.BQk())}function ce(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Log into the Clipperz web application (clipperz.is/app). Click the hamburger menu icon in the\n      top right to expand the navigation bar. Navigate to "Data" → "Export". Click the\n      "download HTML+JSON" button to save the HTML file.\n    '),c.BQk())}function ue(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the RoboForm Editor desktop application, navigate to "RoboForm" (top left) →\n      "Options" → "Account & Data" and click the "Export" button. Select all of your data,\n      change the "Format" to "CSV file" and then click the "Export" button to save the CSV file.\n      Note: RoboForm only allows you to export Logins. Other items will not be exported.\n    '),c.BQk())}function pe(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Log into the Passbolt web vault and navigate to the "Passwords" listing. Select all of the\n      passwords you would like to export and click the "Export" button at the top of the listing.\n      Choose the "csv (lastpass)" export format and click the "Export" button.\n    '),c.BQk())}function he(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Ascendo DataVault desktop application, navigate to "Tools" → "Export". In the\n      dialog that pops up, select the "All Items (DVX, CSV)" option. Click the "Ok" button to save\n      the CSV file.\n    '),c.BQk())}function de(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Password Boss desktop application, navigate to "File" → "Export data" →\n      "Password Boss JSON - not encrypted" and save the JSON file.\n    '),c.BQk())}function me(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Log into the Zoho web vault (vault.zoho.com). Navigate to "Tools" → "Export Secrets".\n      Select "All Secrets" and click the "Zoho Vault Format CSV" button. Highlight and copy the data\n      from the textarea. Open a text editor like Notepad and paste the data. Save the data from the\n      text editor as\n      '),c.TgZ(2,"code"),c._uU(3,"zoho_export.csv"),c.qZA(),c._uU(4,".\n    "),c.BQk())}function fe(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the SplashID Safe desktop application, click on the SplashID blue lock logo in the top\n      right corner. Navigate to "Export" → "Export as CSV" and save the CSV file.\n    '),c.BQk())}function ge(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the PassKeep mobile app, navigate to "Backup/Restore". Locate the "CSV Backup/Restore"\n      section and click "Backup to CSV" to save the CSV file.\n    '),c.BQk())}function ye(e,t){1&e&&(c.ynx(0),c._uU(1,"\n      Make sure you have python-keyring and python-gnomekeyring installed. Save the\n      "),c.TgZ(2,"a",28),c._uU(3,"GNOME Keyring Import/Export"),c.qZA(),c._uU(4,"\n      python script to your desktop as "),c.TgZ(5,"code"),c._uU(6,"pw_helper.py"),c.qZA(),c._uU(7,". Open terminal and run\n      "),c.TgZ(8,"code"),c._uU(9,"chmod +rx Desktop/pw_helper.py"),c.qZA(),c._uU(10," and then\n      "),c.TgZ(11,"code"),c._uU(12,"python Desktop/pw_helper.py export Desktop/my_passwords.json"),c.qZA(),c._uU(13,". Then upload the\n      resulting "),c.TgZ(14,"code"),c._uU(15,"my_passwords.json"),c.qZA(),c._uU(16," file here to Bitwarden.\n    "),c.BQk())}function ve(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Using the Password Agent desktop application navigate to "File" → "Export", select the\n      "Fields to export" button and check all of the fields, change the "Output format" to "CSV",\n      and then click the "Start" button to save the CSV file.\n    '),c.BQk())}function we(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Log into the Passpack website vault and navigate to "Settings" → "Export", then click the\n      "Download" button to save the CSV file.\n    '),c.BQk())}function Oe(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open your Passman vault and click on "Settings" in the bottom left corner. In the "Settings"\n      window switch to the "Export credentials" tab and choose "JSON" as the export type. Enter your\n      vault\'s passphrase and click the "Export" button to save the JSON file.\n    '),c.BQk())}function xe(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the Avast Passwords desktop application and navigate to "Settings" → "Import/export\n      data". Select the "Export" button for the "Export to CSV file" option to save the CSV file.\n    '),c.BQk())}function Ne(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the Avast Passwords desktop application and navigate to "Settings" → "Import/export\n      data". Select the "Export" button for the "Export to JSON file" option to save the JSON file.\n    '),c.BQk())}function Ce(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the F-Secure KEY desktop application and navigate to "Settings" → "Export\n      Passwords". Select the "Export" button, enter your master password, and save the FSK file.\n    '),c.BQk())}function be(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the Kaspersky Password Manager desktop application and navigate to "Settings" →\n      "Import/Export". Locate the "Export to text file" section and select the "Export" button to\n      save the TXT file.\n    '),c.BQk())}function Ue(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the RememBear desktop application and navigate to "Settings" → "Account" →\n      "Export". Enter your master password and select the "Export Anyway" button to save the CSV\n      file.\n    '),c.BQk())}function _e(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the PasswordWallet desktop application and navigate to "File" → "Export" →\n      "Visible entries to text file". Enter your password and select the "Ok" button to save the TXT\n      file.\n    '),c.BQk())}function De(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the Myki desktop browser extension and navigate to "Advanced" → "Export Accounts"\n      and then scan the QR code with your mobile device. Various CSV files will then be saved to\n      your computer\'s downloads folder.\n    '),c.BQk())}function Pe(e,t){1&e&&(c.ynx(0),c._uU(1,"\n      Export your SecureSafe password safe to a CSV file with a comma delimiter.\n    "),c.BQk())}function Ve(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the LogMeOnce browser extension, then navigate to "Open Menu" → "Export To" and\n      select "CSV File" to save the CSV file.\n    '),c.BQk())}function Se(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the BlackBerry Password Keeper application, then navigate to "Settings" →\n      "Import/Export". Select "Export Passwords" and follow the instructions on screen to save the\n      unencrypted CSV file.\n    '),c.BQk())}function ke(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the Buttercup desktop application and unlock your vault. Right click on your vault\'s icon\n      and select "Export" to save the CSV file.\n    '),c.BQk())}function Ee(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      Open the Codebook desktop application and log in. Navigate to "File" → "Export all", then\n      click "Yes" on the dialog and save the CSV file.\n    '),c.BQk())}function Ae(e,t){1&e&&(c.ynx(0),c._uU(1,"\n      Open the newest version of the Encryptr desktop application and allow all of your data to\n      sync. Once syncing of your data is complete, the download icon in the top right corner will\n      turn pink. Click the download icon and save the CSV file.\n    "),c.BQk())}function Te(e,t){1&e&&(c.ynx(0),c._uU(1,'\n      From the Yoti browser extension, click on "Settings", then "Export Saved Logins" and save the\n      CSV file.\n    '),c.BQk())}function Ie(e,t){if(1&e&&(c.TgZ(0,"app-callout",21),c._uU(1,"\n    "),c.YNc(2,F,5,0,"ng-container",10),c._uU(3,"\n    "),c.YNc(4,L,5,0,"ng-container",10),c._uU(5,"\n    "),c.YNc(6,W,2,0,"ng-container",10),c._uU(7,"\n    "),c.YNc(8,Z,2,0,"ng-container",10),c._uU(9,"\n    "),c.YNc(10,q,2,0,"ng-container",10),c._uU(11,"\n    "),c.YNc(12,B,2,0,"ng-container",10),c._uU(13,"\n    "),c.YNc(14,R,2,0,"ng-container",10),c._uU(15,"\n    "),c.YNc(16,M,2,0,"ng-container",10),c._uU(17,"\n    "),c.YNc(18,Y,2,0,"ng-container",10),c._uU(19,"\n    "),c.YNc(20,Q,2,0,"ng-container",10),c._uU(21,"\n    "),c.YNc(22,J,2,0,"ng-container",10),c._uU(23,"\n    "),c.YNc(24,z,2,0,"ng-container",10),c._uU(25,"\n    "),c.YNc(26,j,2,0,"ng-container",10),c._uU(27,"\n    "),c.YNc(28,H,7,1,"ng-container",10),c._uU(29,"\n    "),c.YNc(30,G,5,0,"ng-container",10),c._uU(31,"\n    "),c.YNc(32,$,5,0,"ng-container",10),c._uU(33,"\n    "),c.YNc(34,X,5,0,"ng-container",10),c._uU(35,"\n    "),c.YNc(36,ee,2,0,"ng-container",10),c._uU(37,"\n    "),c.YNc(38,te,2,0,"ng-container",10),c._uU(39,"\n    "),c.YNc(40,se,2,0,"ng-container",10),c._uU(41,"\n    "),c.YNc(42,ie,2,0,"ng-container",10),c._uU(43,"\n    "),c.YNc(44,re,2,0,"ng-container",10),c._uU(45,"\n    "),c.YNc(46,ne,2,0,"ng-container",10),c._uU(47,"\n    "),c.YNc(48,oe,2,0,"ng-container",10),c._uU(49,"\n    "),c.YNc(50,ae,2,0,"ng-container",10),c._uU(51,"\n    "),c.YNc(52,le,2,0,"ng-container",10),c._uU(53,"\n    "),c.YNc(54,ce,2,0,"ng-container",10),c._uU(55,"\n    "),c.YNc(56,ue,2,0,"ng-container",10),c._uU(57,"\n    "),c.YNc(58,pe,2,0,"ng-container",10),c._uU(59,"\n    "),c.YNc(60,he,2,0,"ng-container",10),c._uU(61,"\n    "),c.YNc(62,de,2,0,"ng-container",10),c._uU(63,"\n    "),c.YNc(64,me,5,0,"ng-container",10),c._uU(65,"\n    "),c.YNc(66,fe,2,0,"ng-container",10),c._uU(67,"\n    "),c.YNc(68,ge,2,0,"ng-container",10),c._uU(69,"\n    "),c.YNc(70,ye,17,0,"ng-container",10),c._uU(71,"\n    "),c.YNc(72,ve,2,0,"ng-container",10),c._uU(73,"\n    "),c.YNc(74,we,2,0,"ng-container",10),c._uU(75,"\n    "),c.YNc(76,Oe,2,0,"ng-container",10),c._uU(77,"\n    "),c.YNc(78,xe,2,0,"ng-container",10),c._uU(79,"\n    "),c.YNc(80,Ne,2,0,"ng-container",10),c._uU(81,"\n    "),c.YNc(82,Ce,2,0,"ng-container",10),c._uU(83,"\n    "),c.YNc(84,be,2,0,"ng-container",10),c._uU(85,"\n    "),c.YNc(86,Ue,2,0,"ng-container",10),c._uU(87,"\n    "),c.YNc(88,_e,2,0,"ng-container",10),c._uU(89,"\n    "),c.YNc(90,De,2,0,"ng-container",10),c._uU(91,"\n    "),c.YNc(92,Pe,2,0,"ng-container",10),c._uU(93,"\n    "),c.YNc(94,Ve,2,0,"ng-container",10),c._uU(95,"\n    "),c.YNc(96,Se,2,0,"ng-container",10),c._uU(97,"\n    "),c.YNc(98,ke,2,0,"ng-container",10),c._uU(99,"\n    "),c.YNc(100,Ee,2,0,"ng-container",10),c._uU(101,"\n    "),c.YNc(102,Ae,2,0,"ng-container",10),c._uU(103,"\n    "),c.YNc(104,Te,2,0,"ng-container",10),c._uU(105,"\n  "),c.qZA()),2&e){const e=c.oxw();c.s9C("title",e.getFormatInstructionTitle()),c.xp6(2),c.Q6J("ngIf","bitwardencsv"===e.format||"bitwardenjson"===e.format),c.xp6(2),c.Q6J("ngIf","lastpasscsv"===e.format),c.xp6(2),c.Q6J("ngIf","keepassxcsv"===e.format),c.xp6(2),c.Q6J("ngIf","aviracsv"===e.format),c.xp6(2),c.Q6J("ngIf","blurcsv"===e.format),c.xp6(2),c.Q6J("ngIf","safeincloudxml"===e.format),c.xp6(2),c.Q6J("ngIf","padlockcsv"===e.format),c.xp6(2),c.Q6J("ngIf","keepass2xml"===e.format),c.xp6(2),c.Q6J("ngIf","upmcsv"===e.format),c.xp6(2),c.Q6J("ngIf","saferpasscsv"===e.format),c.xp6(2),c.Q6J("ngIf","meldiumcsv"===e.format),c.xp6(2),c.Q6J("ngIf","keepercsv"===e.format),c.xp6(2),c.Q6J("ngIf","keeperjson"===e.format),c.xp6(2),c.Q6J("ngIf","chromecsv"===e.format||"operacsv"===e.format||"vivaldicsv"===e.format),c.xp6(2),c.Q6J("ngIf","firefoxcsv"===e.format),c.xp6(2),c.Q6J("ngIf","safaricsv"===e.format),c.xp6(2),c.Q6J("ngIf","1password1pux"===e.format||"1password1pif"===e.format||"1passwordwincsv"===e.format||"1passwordmaccsv"===e.format),c.xp6(2),c.Q6J("ngIf","passworddragonxml"===e.format),c.xp6(2),c.Q6J("ngIf","enpasscsv"===e.format),c.xp6(2),c.Q6J("ngIf","enpassjson"===e.format),c.xp6(2),c.Q6J("ngIf","pwsafexml"===e.format),c.xp6(2),c.Q6J("ngIf","dashlanecsv"===e.format),c.xp6(2),c.Q6J("ngIf","dashlanejson"===e.format),c.xp6(2),c.Q6J("ngIf","msecurecsv"===e.format),c.xp6(2),c.Q6J("ngIf","stickypasswordxml"===e.format),c.xp6(2),c.Q6J("ngIf","truekeycsv"===e.format),c.xp6(2),c.Q6J("ngIf","clipperzhtml"===e.format),c.xp6(2),c.Q6J("ngIf","roboformcsv"===e.format),c.xp6(2),c.Q6J("ngIf","passboltcsv"===e.format),c.xp6(2),c.Q6J("ngIf","ascendocsv"===e.format),c.xp6(2),c.Q6J("ngIf","passwordbossjson"===e.format),c.xp6(2),c.Q6J("ngIf","zohovaultcsv"===e.format),c.xp6(2),c.Q6J("ngIf","splashidcsv"===e.format),c.xp6(2),c.Q6J("ngIf","passkeepcsv"===e.format),c.xp6(2),c.Q6J("ngIf","gnomejson"===e.format),c.xp6(2),c.Q6J("ngIf","passwordagentcsv"===e.format),c.xp6(2),c.Q6J("ngIf","passpackcsv"===e.format),c.xp6(2),c.Q6J("ngIf","passmanjson"===e.format),c.xp6(2),c.Q6J("ngIf","avastcsv"===e.format),c.xp6(2),c.Q6J("ngIf","avastjson"===e.format),c.xp6(2),c.Q6J("ngIf","fsecurefsk"===e.format),c.xp6(2),c.Q6J("ngIf","kasperskytxt"===e.format),c.xp6(2),c.Q6J("ngIf","remembearcsv"===e.format),c.xp6(2),c.Q6J("ngIf","passwordwallettxt"===e.format),c.xp6(2),c.Q6J("ngIf","mykicsv"===e.format),c.xp6(2),c.Q6J("ngIf","securesafecsv"===e.format),c.xp6(2),c.Q6J("ngIf","logmeoncecsv"===e.format),c.xp6(2),c.Q6J("ngIf","blackberrycsv"===e.format),c.xp6(2),c.Q6J("ngIf","buttercupcsv"===e.format),c.xp6(2),c.Q6J("ngIf","codebookcsv"===e.format),c.xp6(2),c.Q6J("ngIf","encryptrcsv"===e.format),c.xp6(2),c.Q6J("ngIf","yoticsv"===e.format)}}const Fe=function(e){return{manual:e}};class Le{constructor(e,t,s,i,r,n,o){this.i18nService=e,this.importService=t,this.router=s,this.platformUtilsService=i,this.policyService=r,this.logService=n,this.modalService=o,this.format=null,this.loading=!1,this.importBlockedByPolicy=!1,this.organizationId=null,this.successNavigate=["vault"]}ngOnInit(){return k(this,void 0,void 0,(function*(){this.setImportOptions(),this.importBlockedByPolicy=yield this.policyService.policyAppliesToUser(a.M.PersonalOwnership)}))}submit(){return k(this,void 0,void 0,(function*(){if(this.importBlockedByPolicy)return void this.platformUtilsService.showToast("error",null,this.i18nService.t("personalOwnershipPolicyInEffectImports"));this.loading=!0;const e=this.importService.getImporter(this.format,this.organizationId);if(null===e)return this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("selectFormat")),void(this.loading=!1);const t=document.getElementById("file").files;if(!(null!=t&&0!==t.length||null!=this.fileContents&&""!==this.fileContents))return this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("selectFile")),void(this.loading=!1);let s=this.fileContents;if(null!=t&&t.length>0)try{const e=yield this.getFileContents(t[0]);null!=e&&(s=e)}catch(i){this.logService.error(i)}if(null==s||""===s)return this.platformUtilsService.showToast("error",this.i18nService.t("errorOccurred"),this.i18nService.t("selectFile")),void(this.loading=!1);try{this.formPromise=this.importService.import(e,s,this.organizationId);let t=yield this.formPromise;if(null==t?void 0:t.passwordRequired){const e=yield this.getFilePassword();if(null==e)return void(this.loading=!1);t=yield this.doPasswordProtectedImport(e,s)}if(null!=t)return this.error(t),void(this.loading=!1);this.platformUtilsService.showToast("success",null,this.i18nService.t("importSuccess")),this.router.navigate(this.successNavigate)}catch(i){this.logService.error(i)}this.loading=!1}))}getFormatInstructionTitle(){if(null==this.format)return null;const e=this.featuredImportOptions.concat(this.importOptions).filter((e=>e.id===this.format));return e.length>0?this.i18nService.t("instructionsFor",e[0].name):null}setImportOptions(){this.featuredImportOptions=[{id:null,name:"-- "+this.i18nService.t("select")+" --"},...this.importService.featuredImportOptions],this.importOptions=[...this.importService.regularImportOptions].sort(((e,t)=>null==e.name&&null!=t.name?-1:null!=e.name&&null==t.name?1:null==e.name&&null==t.name?0:this.i18nService.collator?this.i18nService.collator.compare(e.name,t.name):e.name.localeCompare(t.name)))}error(e){return k(this,void 0,void 0,(function*(){yield n().fire({heightAuto:!1,buttonsStyling:!1,icon:"error",iconHtml:'<i class="swal-custom-icon bwi bwi-error text-danger"></i>',input:"textarea",inputValue:e.message,inputAttributes:{readonly:"true"},titleText:this.i18nService.t("importError"),text:this.i18nService.t("importErrorDesc"),showConfirmButton:!0,confirmButtonText:this.i18nService.t("ok"),onOpen:e=>{e.querySelector(".swal2-textarea").scrollTo(0,0)}})}))}getFileContents(e){return"1password1pux"===this.format?this.extract1PuxContent(e):new Promise(((t,s)=>{const i=new FileReader;i.readAsText(e,"utf-8"),i.onload=i=>{if("lastpasscsv"===this.format&&"text/html"===e.type){const e=(new DOMParser).parseFromString(i.target.result,"text/html").querySelector("pre");return null!=e?void t(e.textContent):void s()}t(i.target.result)},i.onerror=()=>{s()}}))}extract1PuxContent(e){return(new i).loadAsync(e).then((e=>e.file("export.data").async("string"))).then((function(e){return e}),(function(e){return""}))}getFilePassword(){return k(this,void 0,void 0,(function*(){const e=this.modalService.open(C,{allowMultipleModals:!0});return null==e?null:yield e.onClosedPromise()}))}doPasswordProtectedImport(e,t){return k(this,void 0,void 0,(function*(){const s=this.importService.getImporter("bitwardenpasswordprotected",this.organizationId,e);return this.importService.import(s,t,this.organizationId)}))}}Le.ɵfac=function(e){return new(e||Le)(c.Y36(b.D),c.Y36(U.Y),c.Y36(_.F0),c.Y36(D.P),c.Y36(P.d),c.Y36(V.$),c.Y36(o.Z))},Le.ɵcmp=c.Xpm({type:Le,selectors:[["app-import"]],decls:69,vars:31,consts:[[1,"page-header"],["type","info",4,"ngIf"],["ngNativeValidate","",3,"ngSubmit"],["form",""],[1,"row"],[1,"col-6"],[1,"form-group"],["for","type"],["id","type","name","Format","required","",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[4,"ngIf"],["type","info",3,"title",4,"ngIf"],["for","file"],["type","file","id","file","name","file",1,"form-control-file",3,"disabled"],["for","fileContents"],["id","fileContents","name","FileContents",1,"form-control",3,"ngModel","disabled","ngModelChange"],["type","submit",1,"btn","btn-primary","btn-submit",3,"disabled","ngClass"],["aria-hidden","true",1,"bwi","bwi-spinner","bwi-spin",3,"title"],["type","info"],[3,"ngValue"],["value","-","disabled",""],["type","info",3,"title"],["target","_blank","rel","noopener","href","https://bitwarden.com/help/export-your-data/"],["target","_blank","rel","noopener","href","https://bitwarden.com/help/import-from-lastpass/"],["target","_blank","rel","noopener","href","https://bitwarden.com/help/import-from-chrome/"],["target","_blank","rel","noopener","href","https://bitwarden.com/help/import-from-firefox/"],["target","_blank","rel","noopener","href","https://bitwarden.com/help/import-from-safari/"],["target","_blank","rel","noopener","href","https://bitwarden.com/help/import-from-1password/"],["target","_blank","rel","noopener","href","https://bit.ly/2GpOMTg"]],template:function(e,t){1&e&&(c.TgZ(0,"div",0),c._uU(1,"\n  "),c.TgZ(2,"h1"),c._uU(3),c.ALo(4,"i18n"),c.qZA(),c._uU(5,"\n"),c.qZA(),c._uU(6,"\n"),c.YNc(7,E,3,3,"app-callout",1),c._uU(8,"\n"),c.TgZ(9,"form",2,3),c.NdJ("ngSubmit",(function(){return t.submit()})),c._uU(11,"\n  "),c.TgZ(12,"div",4),c._uU(13,"\n    "),c.TgZ(14,"div",5),c._uU(15,"\n      "),c.TgZ(16,"div",6),c._uU(17,"\n        "),c.TgZ(18,"label",7),c._uU(19),c.ALo(20,"i18n"),c.qZA(),c._uU(21,"\n        "),c.TgZ(22,"select",8),c.NdJ("ngModelChange",(function(e){return t.format=e})),c._uU(23,"\n          "),c.YNc(24,A,2,2,"option",9),c._uU(25,"\n          "),c.YNc(26,I,6,1,"ng-container",10),c._uU(27,"\n        "),c.qZA(),c._uU(28,"\n      "),c.qZA(),c._uU(29,"\n    "),c.qZA(),c._uU(30,"\n  "),c.qZA(),c._uU(31,"\n  "),c.YNc(32,Ie,106,53,"app-callout",11),c._uU(33,"\n  "),c.TgZ(34,"div",4),c._uU(35,"\n    "),c.TgZ(36,"div",5),c._uU(37,"\n      "),c.TgZ(38,"div",6),c._uU(39,"\n        "),c.TgZ(40,"label",12),c._uU(41),c.ALo(42,"i18n"),c.qZA(),c._uU(43,"\n        "),c._UZ(44,"input",13),c._uU(45,"\n      "),c.qZA(),c._uU(46,"\n    "),c.qZA(),c._uU(47,"\n  "),c.qZA(),c._uU(48,"\n  "),c.TgZ(49,"div",6),c._uU(50,"\n    "),c.TgZ(51,"label",14),c._uU(52),c.ALo(53,"i18n"),c.qZA(),c._uU(54,"\n    "),c.TgZ(55,"textarea",15),c.NdJ("ngModelChange",(function(e){return t.fileContents=e})),c.qZA(),c._uU(56,"\n  "),c.qZA(),c._uU(57,"\n  "),c.TgZ(58,"button",16),c._uU(59,"\n    "),c._UZ(60,"i",17),c.ALo(61,"i18n"),c._uU(62,"\n    "),c.TgZ(63,"span"),c._uU(64),c.ALo(65,"i18n"),c.qZA(),c._uU(66,"\n  "),c.qZA(),c._uU(67,"\n"),c.qZA(),c._uU(68,"\n")),2&e&&(c.xp6(3),c.Oqu(c.lcZ(4,17,"importData")),c.xp6(4),c.Q6J("ngIf",t.importBlockedByPolicy),c.xp6(12),c.hij("1. ",c.lcZ(20,19,"selectFormat"),""),c.xp6(3),c.Q6J("ngModel",t.format)("disabled",t.importBlockedByPolicy),c.xp6(2),c.Q6J("ngForOf",t.featuredImportOptions),c.xp6(2),c.Q6J("ngIf",t.importOptions&&t.importOptions.length),c.xp6(6),c.Q6J("ngIf",t.format),c.xp6(9),c.hij("2. ",c.lcZ(42,21,"selectImportFile"),""),c.xp6(3),c.Q6J("disabled",t.importBlockedByPolicy),c.xp6(8),c.Oqu(c.lcZ(53,23,"orCopyPasteFileContents")),c.xp6(3),c.Q6J("ngModel",t.fileContents)("disabled",t.importBlockedByPolicy),c.xp6(3),c.Q6J("disabled",t.loading||t.importBlockedByPolicy)("ngClass",c.VKq(29,Fe,t.importBlockedByPolicy)),c.xp6(2),c.s9C("title",c.lcZ(61,25,"loading")),c.xp6(4),c.Oqu(c.lcZ(65,27,"importData")))},dependencies:[p.mk,p.sg,p.O5,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.Q7,l.On,l.F,S.O,x.C],encapsulation:2})},70919:(e,t,s)=>{s.d(t,{N:()=>p});var i=s(24852),r=s(41320),n=s(64184),o=s(19419),a=s(53707),l=s(17404),c=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{l(i.next(e))}catch(t){n(t)}}function a(e){try{l(i.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};function u(e,t){if(1&e&&(i.ynx(0),i._uU(1,"\n  "),i.TgZ(2,"app-callout",1),i.ALo(3,"i18n"),i._uU(4),i.ALo(5,"i18n"),i.qZA(),i._uU(6,"\n"),i.BQk()),2&e){const e=i.oxw();i.xp6(2),i.s9C("title",i.lcZ(3,2,e.scopeConfig.title)),i.xp6(2),i.hij("\n    ",i.xi3(5,4,e.scopeConfig.description,e.scopeConfig.scopeIdentifier),"\n  ")}}class p{constructor(e,t){this.organizationService=e,this.stateService=t,this.organizationId=null,this.show=!1}ngOnInit(){return c(this,void 0,void 0,(function*(){(yield this.organizationService.hasOrganizations())&&(this.scopeConfig=null!=this.organizationId?{title:"exportingOrganizationVaultTitle",description:"exportingOrganizationVaultDescription",scopeIdentifier:(yield this.organizationService.get(this.organizationId)).name}:{title:"exportingPersonalVaultTitle",description:"exportingPersonalVaultDescription",scopeIdentifier:yield this.stateService.getEmail()},this.show=!0)}))}}p.ɵfac=function(e){return new(e||p)(i.Y36(r.M),i.Y36(n.b))},p.ɵcmp=i.Xpm({type:p,selectors:[["app-export-scope-callout"]],inputs:{organizationId:"organizationId"},decls:2,vars:1,consts:[[4,"ngIf"],["type","info",3,"title"]],template:function(e,t){1&e&&(i.YNc(0,u,7,7,"ng-container",0),i._uU(1,"\n")),2&e&&i.Q6J("ngIf",t.show)},dependencies:[o.O5,a.O,l.C],encapsulation:2})},25376:(e,t,s)=>{s.d(t,{$:()=>r});var i=s(24852);class r{constructor(e){this.el=null,this.el=e.nativeElement}ngOnInit(){this.formEls=Array.from(this.el.querySelectorAll('input:not([type="hidden"]), select, textarea')),this.formEls.forEach((e=>{e.addEventListener("focus",(()=>{this.el.classList.add("active")}),!1),e.addEventListener("blur",(()=>{this.el.classList.remove("active")}),!1)}))}onClick(e){const t=e.target;if((t===this.el||t.classList.contains("progress")||t.classList.contains("progress-bar"))&&this.formEls.length>0){const e=this.formEls[0];if("input"===e.tagName.toLowerCase()){const t=e;if(null!=t.type&&"checkbox"===t.type.toLowerCase())return void t.click()}e.focus()}}}r.ɵfac=function(e){return new(e||r)(i.Y36(i.SBq))},r.ɵdir=i.lG2({type:r,selectors:[["","appBoxRow",""]],hostBindings:function(e,t){1&e&&i.NdJ("click",(function(e){return t.onClick(e)}))}})},2798:(e,t,s)=>{s.d(t,{Y:()=>i});class i{}},70657:(e,t,s)=>{s.d(t,{Y:()=>ut});var i=s(32001);const r=[{id:"bitwardenjson",name:"Bitwarden (json)"},{id:"bitwardencsv",name:"Bitwarden (csv)"},{id:"chromecsv",name:"Chrome (csv)"},{id:"dashlanecsv",name:"Dashlane (csv)"},{id:"firefoxcsv",name:"Firefox (csv)"},{id:"keepass2xml",name:"KeePass 2 (xml)"},{id:"lastpasscsv",name:"LastPass (csv)"},{id:"safaricsv",name:"Safari and macOS (csv)"},{id:"1password1pux",name:"1Password (1pux)"}],n=[{id:"keepassxcsv",name:"KeePassX (csv)"},{id:"1password1pif",name:"1Password (1pif)"},{id:"1passwordwincsv",name:"1Password 6 and 7 Windows (csv)"},{id:"1passwordmaccsv",name:"1Password 6 and 7 Mac (csv)"},{id:"dashlanejson",name:"Dashlane (json)"},{id:"roboformcsv",name:"RoboForm (csv)"},{id:"keepercsv",name:"Keeper (csv)"},{id:"enpasscsv",name:"Enpass (csv)"},{id:"enpassjson",name:"Enpass (json)"},{id:"safeincloudxml",name:"SafeInCloud (xml)"},{id:"pwsafexml",name:"Password Safe (xml)"},{id:"stickypasswordxml",name:"Sticky Password (xml)"},{id:"msecurecsv",name:"mSecure (csv)"},{id:"truekeycsv",name:"True Key (csv)"},{id:"passwordbossjson",name:"Password Boss (json)"},{id:"zohovaultcsv",name:"Zoho Vault (csv)"},{id:"splashidcsv",name:"SplashID (csv)"},{id:"passworddragonxml",name:"Password Dragon (xml)"},{id:"padlockcsv",name:"Padlock (csv)"},{id:"passboltcsv",name:"Passbolt (csv)"},{id:"clipperzhtml",name:"Clipperz (html)"},{id:"aviracsv",name:"Avira (csv)"},{id:"saferpasscsv",name:"SaferPass (csv)"},{id:"upmcsv",name:"Universal Password Manager (csv)"},{id:"ascendocsv",name:"Ascendo DataVault (csv)"},{id:"meldiumcsv",name:"Meldium (csv)"},{id:"passkeepcsv",name:"PassKeep (csv)"},{id:"operacsv",name:"Opera (csv)"},{id:"vivaldicsv",name:"Vivaldi (csv)"},{id:"gnomejson",name:"GNOME Passwords and Keys/Seahorse (json)"},{id:"blurcsv",name:"Blur (csv)"},{id:"passwordagentcsv",name:"Password Agent (csv)"},{id:"passpackcsv",name:"Passpack (csv)"},{id:"passmanjson",name:"Passman (json)"},{id:"avastcsv",name:"Avast Passwords (csv)"},{id:"avastjson",name:"Avast Passwords (json)"},{id:"fsecurefsk",name:"F-Secure KEY (fsk)"},{id:"kasperskytxt",name:"Kaspersky Password Manager (txt)"},{id:"remembearcsv",name:"RememBear (csv)"},{id:"passwordwallettxt",name:"PasswordWallet (txt)"},{id:"mykicsv",name:"Myki (csv)"},{id:"securesafecsv",name:"SecureSafe (csv)"},{id:"logmeoncecsv",name:"LogMeOnce (csv)"},{id:"blackberrycsv",name:"BlackBerry Password Keeper (csv)"},{id:"buttercupcsv",name:"Buttercup (csv)"},{id:"codebookcsv",name:"Codebook (csv)"},{id:"encryptrcsv",name:"Encryptr (csv)"},{id:"yoticsv",name:"Yoti (csv)"},{id:"nordpasscsv",name:"Nordpass (csv)"}];class o{constructor(){this.success=!1,this.missingPassword=!1,this.ciphers=[],this.folders=[],this.folderRelationships=[],this.collections=[],this.collectionRelationships=[]}}var a=s(59778),l=s(69064),c=s(78790),u=s(14512),p=s(91414),h=s(70368),d=s(98197),m=s(58255),f=s(5644),g=s(83297),y=s(99053),v=s(62119);class w{constructor(){this.organizationId=null,this.logService=new v.d(!1),this.newLineRegex=/(?:\r\n|\r|\n)/,this.passwordFieldNames=["password","pass word","passphrase","pass phrase","pass","code","code word","codeword","secret","secret word","personpwd","key","keyword","key word","keyphrase","key phrase","form_pw","wppassword","pin","pwd","pw","pword","passwd","p","serial","serial#","license key","reg #","passwort"],this.usernameFieldNames=["user","name","user name","username","login name","email","e-mail","id","userid","user id","login","form_loginname","wpname","mail","loginid","login id","log","personlogin","first name","last name","card#","account #","member","member #","nom","benutzername"],this.notesFieldNames=["note","notes","comment","comments","memo","description","free form","freeform","free text","freetext","free","kommentar"],this.uriFieldNames=["url","hyper link","hyperlink","link","host","hostname","host name","server","address","hyper ref","href","web","website","web site","site","web-site","uri","ort","adresse"],this.parseCsvOptions={encoding:"UTF-8",skipEmptyLines:!1}}get organization(){return null!=this.organizationId}parseXml(e){const t=(new DOMParser).parseFromString(e,"application/xml");return null!=t&&null==t.querySelector("parsererror")?t:null}parseCsv(e,t,s={}){const i=Object.assign({header:t},this.parseCsvOptions,s);e=this.splitNewLine(e).join("\n").trim();const r=a.parse(e,i);return null!=r.errors&&r.errors.length>0&&r.errors.forEach((e=>{null!=e.row&&this.logService.warning("Error parsing row "+e.row+": "+e.message)})),r.data&&r.data.length>0?r.data:null}parseSingleRowCsv(e){if(this.isNullOrWhitespace(e))return null;const t=this.parseCsv(e,!1);return null!=t&&t.length>0&&t[0].length>0?t[0]:null}makeUriArray(e){if(null==e)return null;if("string"==typeof e){const t=new f.E;return t.uri=this.fixUri(e),this.isNullOrWhitespace(t.uri)?null:(t.match=null,[t])}if(e.length>0){const t=[];return e.forEach((e=>{const s=new f.E;s.uri=this.fixUri(e),this.isNullOrWhitespace(s.uri)||(s.match=null,t.push(s))})),0===t.length?null:t}return null}fixUri(e){return null==e?null:(-1===(e=e.trim()).indexOf("://")&&e.indexOf(".")>=0&&(e="http://"+e),e.length>1e3?e.substring(0,1e3):e)}nameFromUrl(e){const t=u.c.getHostname(e);return this.isNullOrWhitespace(t)?null:t.startsWith("www.")?t.replace("www.",""):t}isNullOrWhitespace(e){return u.c.isNullOrWhitespace(e)}getValueOrDefault(e,t=null){return this.isNullOrWhitespace(e)?t:e}splitNewLine(e){return e.split(this.newLineRegex)}getCardBrand(e){if(this.isNullOrWhitespace(e))return null;let t=new RegExp("^4");return null!=e.match(t)?"Visa":/^(5[1-5][0-9]{14}|2(22[1-9][0-9]{12}|2[3-9][0-9]{13}|[3-6][0-9]{14}|7[0-1][0-9]{13}|720[0-9]{12}))$/.test(e)?"Mastercard":(t=new RegExp("^3[47]"),null!=e.match(t)?"Amex":(t=new RegExp("^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)"),null!=e.match(t)?"Discover":(t=new RegExp("^36"),null!=e.match(t)?"Diners Club":(t=new RegExp("^30[0-5]"),null!=e.match(t)?"Diners Club":(t=new RegExp("^35(2[89]|[3-8][0-9])"),null!=e.match(t)?"JCB":(t=new RegExp("^(4026|417500|4508|4844|491(3|7))"),null!=e.match(t)?"Visa":(t=new RegExp("^220[0-4]"),null!=e.match(t)?"Mir":null)))))))}setCardExpiration(e,t){if(!this.isNullOrWhitespace(t)){const s=(t=t.replace(/\s/g,"")).split("/");if(2===s.length){let t=null,i=null;if(1!==s[0].length&&2!==s[0].length||(t=s[0],2===t.length&&"0"===t[0]&&(t=t.substr(1,1))),2!==s[1].length&&4!==s[1].length||(i=2===t.length?"20"+s[1]:s[1]),null!=t&&null!=i)return e.card.expMonth=t,e.card.expYear=i,!0}}return!1}moveFoldersToCollections(e){e.folderRelationships.forEach((t=>e.collectionRelationships.push(t))),e.collections=e.folders.map((e=>{const t=new h.n;return t.name=e.name,t})),e.folderRelationships=[],e.folders=[]}querySelectorDirectChild(e,t){const s=this.querySelectorAllDirectChild(e,t);return 0===s.length?null:s[0]}querySelectorAllDirectChild(e,t){return Array.from(e.querySelectorAll(t)).filter((t=>t.parentNode===e))}initLoginCipher(){const e=new p.$;return e.favorite=!1,e.notes="",e.fields=[],e.login=new g.q,e.type=i.O.Login,e}cleanupCipher(e){null!=e&&(e.type!==i.O.Login&&(e.login=null),this.isNullOrWhitespace(e.name)&&(e.name="--"),this.isNullOrWhitespace(e.notes)?e.notes=null:e.notes=e.notes.trim(),null!=e.fields&&0===e.fields.length&&(e.fields=null))}processKvp(e,t,s,i=l.f.Text){if(!this.isNullOrWhitespace(s))if(this.isNullOrWhitespace(t)&&(t=""),s.length>200||s.trim().search(this.newLineRegex)>-1)null==e.notes&&(e.notes=""),e.notes+=t+": "+this.splitNewLine(s).join("\n")+"\n";else{null==e.fields&&(e.fields=[]);const r=new d.k;r.type=i,r.name=t,r.value=s,e.fields.push(r)}}processFolder(e,t){let s=e.folders.length;const i=!this.isNullOrWhitespace(t);let r=i;if(i)for(let n=0;n<e.folders.length;n++)if(e.folders[n].name===t){r=!1,s=n;break}if(r){const s=new m.a;s.name=t,e.folders.push(s)}i&&e.folderRelationships.push([e.ciphers.length,s])}convertToNoteIfNeeded(e){e.type===i.O.Login&&this.isNullOrWhitespace(e.login.username)&&this.isNullOrWhitespace(e.login.password)&&(null==e.login.uris||0===e.login.uris.length)&&(e.type=i.O.SecureNote,e.secureNote=new y.z,e.secureNote.type=c.x.Generic)}processFullName(e,t){if(this.isNullOrWhitespace(t))return;const s=t.split(" ");s.length>0&&(e.identity.firstName=this.getValueOrDefault(s[0])),2===s.length?e.identity.lastName=this.getValueOrDefault(s[1]):s.length>=3&&(e.identity.middleName=this.getValueOrDefault(s[1]),e.identity.lastName=s.slice(2,s.length).join(" "))}}class O extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(e.length<2)return;const s=this.initLoginCipher();if(s.notes=this.getValueOrDefault(e[e.length-1]),s.name=this.getValueOrDefault(e[0],"--"),e.length>2&&e.length%2==0)for(let t=0;t<e.length-2;t+=2){const i=e[t+2],r=e[t+1];if(this.isNullOrWhitespace(i)||this.isNullOrWhitespace(r))continue;const n=r.toLowerCase();null==s.login.password&&this.passwordFieldNames.indexOf(n)>-1?s.login.password=this.getValueOrDefault(i):null==s.login.username&&this.usernameFieldNames.indexOf(n)>-1?s.login.username=this.getValueOrDefault(i):(null==s.login.uris||0===s.login.uris.length)&&this.uriFieldNames.indexOf(n)>-1?s.login.uris=this.makeUriArray(i):this.processKvp(s,r,i)}this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class x extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.name),s.login.uris=this.makeUriArray(e.web),s.login.password=this.getValueOrDefault(e.password),s.login.username=this.getValueOrDefault(e.login),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class N extends w{parse(e){const t=new o,s=JSON.parse(e);return null==s?(t.success=!1,Promise.resolve(t)):(null!=s.logins&&s.logins.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.custName),s.notes=this.getValueOrDefault(e.note),s.login.uris=this.makeUriArray(e.url),s.login.password=this.getValueOrDefault(e.pwd),s.login.username=this.getValueOrDefault(e.loginName),this.cleanupCipher(s),t.ciphers.push(s)})),null!=s.notes&&s.notes.forEach((e=>{const s=this.initLoginCipher();s.type=i.O.SecureNote,s.secureNote.type=c.x.Generic,s.name=this.getValueOrDefault(e.label),s.notes=this.getValueOrDefault(e.text),this.cleanupCipher(s),t.ciphers.push(s)})),null!=s.cards&&s.cards.forEach((e=>{const s=this.initLoginCipher();s.type=i.O.Card,s.name=this.getValueOrDefault(e.custName),s.notes=this.getValueOrDefault(e.note),s.card.cardholderName=this.getValueOrDefault(e.holderName),s.card.number=this.getValueOrDefault(e.cardNumber),s.card.code=this.getValueOrDefault(e.cvv),s.card.brand=this.getCardBrand(s.card.number),null!=e.expirationDate&&(null!=e.expirationDate.month&&(s.card.expMonth=e.expirationDate.month+""),null!=e.expirationDate.year&&(s.card.expYear=e.expirationDate.year+"")),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class C extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.name,this.getValueOrDefault(this.nameFromUrl(e.website),"--")),s.login.uris=this.makeUriArray(e.website),s.login.password=this.getValueOrDefault(e.password),this.isNullOrWhitespace(e.username)&&!this.isNullOrWhitespace(e.secondary_username)?s.login.username=e.secondary_username:(s.login.username=this.getValueOrDefault(e.username),s.notes=this.getValueOrDefault(e.secondary_username)),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}var b=s(26702);class U extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(this.organization&&!this.isNullOrWhitespace(e.collections)){e.collections.split(",").forEach((e=>{let s=!0,i=t.collections.length;for(let r=0;r<t.collections.length;r++)if(t.collections[r].name===e){s=!1,i=r;break}if(s){const s=new h.n;s.name=e,t.collections.push(s)}t.collectionRelationships.push([t.ciphers.length,i])}))}else this.organization||this.processFolder(t,e.folder);const s=new p.$;s.favorite=!this.organization&&"0"!==this.getValueOrDefault(e.favorite,"0"),s.type=i.O.Login,s.notes=this.getValueOrDefault(e.notes),s.name=this.getValueOrDefault(e.name,"--");try{s.reprompt=parseInt(this.getValueOrDefault(e.reprompt,b.N.None.toString()),10)}catch(r){console.error("Unable to parse reprompt value",r),s.reprompt=b.N.None}if(!this.isNullOrWhitespace(e.fields)){const t=this.splitNewLine(e.fields);for(let e=0;e<t.length;e++){if(this.isNullOrWhitespace(t[e]))continue;const i=t[e].lastIndexOf(": ");if(-1===i)continue;null==s.fields&&(s.fields=[]);const r=new d.k;r.name=t[e].substr(0,i),r.value=null,r.type=l.f.Text,t[e].length>i+2&&(r.value=t[e].substr(i+2)),s.fields.push(r)}}switch(null!=e.type?e.type.toLowerCase():null){case"note":s.type=i.O.SecureNote,s.secureNote=new y.z,s.secureNote.type=c.x.Generic;break;default:{s.type=i.O.Login,s.login=new g.q,s.login.totp=this.getValueOrDefault(e.login_totp||e.totp),s.login.username=this.getValueOrDefault(e.login_username||e.username),s.login.password=this.getValueOrDefault(e.login_password||e.password);const t=this.parseSingleRowCsv(e.login_uri||e.uri);s.login.uris=this.makeUriArray(t);break}}t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}var _=s(71498),D=s(23702),P=s(43579),V=s(38685),S=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{l(i.next(e))}catch(t){n(t)}}function a(e){try{l(i.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class k extends w{constructor(e,t){super(),this.cryptoService=e,this.i18nService=t}parse(e){var t;return S(this,void 0,void 0,(function*(){return this.result=new o,this.results=JSON.parse(e),null==this.results||null==this.results.items?(null===(t=this.results)||void 0===t?void 0:t.passwordProtected)?(this.result.success=!1,this.result.missingPassword=!0,this.result.errorMessage=this.i18nService.t("importPasswordRequired"),this.result):(this.result.success=!1,this.result):(this.results.encrypted?yield this.parseEncrypted():this.parseDecrypted(),this.result)}))}parseEncrypted(){return S(this,void 0,void 0,(function*(){if(null!=this.results.encKeyValidation_DO_NOT_EDIT){const e=yield this.cryptoService.getOrgKey(this.organizationId),t=new _._(this.results.encKeyValidation_DO_NOT_EDIT);if(null===(yield this.cryptoService.decryptToUtf8(t,e)))return this.result.success=!1,void(this.result.errorMessage=this.i18nService.t("importEncKeyError"))}const e=new Map;if(this.organization&&null!=this.results.collections)for(const t of this.results.collections){const s=P.l.toDomain(t);if(null!=s){s.id=null,s.organizationId=this.organizationId;const i=yield s.decrypt();e.set(t.id,this.result.collections.length),this.result.collections.push(i)}}else if(!this.organization&&null!=this.results.folders)for(const t of this.results.folders){const s=V.L.toDomain(t);if(null!=s){s.id=null;const i=yield s.decrypt();e.set(t.id,this.result.folders.length),this.result.folders.push(i)}}for(const t of this.results.items){const s=D.R.toDomain(t);s.id=null,s.folderId=null,s.organizationId=this.organizationId,s.collectionIds=null,null!=s.passwordHistory&&s.passwordHistory.length>5&&(s.passwordHistory=s.passwordHistory.slice(0,5)),!this.organization&&null!=t.folderId&&e.has(t.folderId)?this.result.folderRelationships.push([this.result.ciphers.length,e.get(t.folderId)]):this.organization&&null!=t.collectionIds&&t.collectionIds.forEach((t=>{e.has(t)&&this.result.collectionRelationships.push([this.result.ciphers.length,e.get(t)])}));const i=yield s.decrypt();this.cleanupCipher(i),this.result.ciphers.push(i)}this.result.success=!0}))}parseDecrypted(){const e=new Map;this.organization&&null!=this.results.collections?this.results.collections.forEach((t=>{const s=P.l.toView(t);null!=s&&(s.id=null,s.organizationId=null,e.set(t.id,this.result.collections.length),this.result.collections.push(s))})):this.organization||null==this.results.folders||this.results.folders.forEach((t=>{const s=V.L.toView(t);null!=s&&(s.id=null,e.set(t.id,this.result.folders.length),this.result.folders.push(s))})),this.results.items.forEach((t=>{const s=D.R.toView(t);s.id=null,s.folderId=null,s.organizationId=null,s.collectionIds=null,null!=s.passwordHistory&&s.passwordHistory.length>5&&(s.passwordHistory=s.passwordHistory.slice(0,5)),!this.organization&&null!=t.folderId&&e.has(t.folderId)?this.result.folderRelationships.push([this.result.ciphers.length,e.get(t.folderId)]):this.organization&&null!=t.collectionIds&&t.collectionIds.forEach((t=>{e.has(t)&&this.result.collectionRelationships.push([this.result.ciphers.length,e.get(t)])})),this.cleanupCipher(s),this.result.ciphers.push(s)})),this.result.success=!0}}var E=s(51094),A=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{l(i.next(e))}catch(t){n(t)}}function a(e){try{l(i.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class T extends k{constructor(e,t,s){super(e,t),this.password=s}parse(e){const t=Object.create(null,{parse:{get:()=>super.parse}});return A(this,void 0,void 0,(function*(){const s=new o,i=JSON.parse(e);if(this.cannotParseFile(i))return s.success=!1,s;if(!(yield this.checkPassword(i)))return s.success=!1,s.errorMessage=this.i18nService.t("invalidFilePassword"),s;const r=new _._(i.data),n=yield this.cryptoService.decryptToUtf8(r,this.key);return yield t.parse.call(this,n)}))}checkPassword(e){return A(this,void 0,void 0,(function*(){this.key=yield this.cryptoService.makePinKey(this.password,e.salt,E.G3.PBKDF2_SHA256,e.kdfIterations);const t=new _._(e.encKeyValidation_DO_NOT_EDIT);return null!==(yield this.cryptoService.decryptToUtf8(t,this.key))}))}cannotParseFile(e){return!(e&&e.encrypted&&e.passwordProtected&&e.salt&&e.kdfIterations&&"number"==typeof e.kdfIterations&&null!=e.kdfType&&null!=E.G3[e.kdfType]&&e.encKeyValidation_DO_NOT_EDIT&&e.data)}}class I extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if("list"===e.grouping)return;const s=this.initLoginCipher();s.favorite="1"===e.fav,s.name=this.getValueOrDefault(e.name),s.notes=this.getValueOrDefault(e.extra),"note"!==e.grouping&&(s.login.uris=this.makeUriArray(e.url),s.login.password=this.getValueOrDefault(e.password),s.login.username=this.getValueOrDefault(e.username)),this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class F extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{"null"===e.label&&(e.label=null);const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.label,this.getValueOrDefault(this.nameFromUrl(e.domain),"--")),s.login.uris=this.makeUriArray(e.domain),s.login.password=this.getValueOrDefault(e.password),this.isNullOrWhitespace(e.email)&&!this.isNullOrWhitespace(e.username)?s.login.username=e.username:(s.login.username=this.getValueOrDefault(e.email),s.notes=this.getValueOrDefault(e.username)),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}const L=["!group_id","!group_name","title","username","password","URL","id"];class W extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{this.processFolder(t,this.getValueOrDefault(e["!group_name"]));const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.title,"--"),s.login.username=this.getValueOrDefault(e.username),s.login.password=this.getValueOrDefault(e.password),s.login.uris=this.makeUriArray(e.URL);let i=!1;for(const t in e)e.hasOwnProperty(t)&&(i||-1!==L.indexOf(t)||(i=!0),i&&this.processKvp(s,t,e[t]));this.cleanupCipher(s),t.ciphers.push(s)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}}class Z extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.name,"--"),s.login.username=this.getValueOrDefault(e.username),s.login.password=this.getValueOrDefault(e.password),s.login.uris=this.makeUriArray(e.url),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class q extends w{parse(e){const t=new o,s=this.parseXml(e);if(null==s)return t.success=!1,Promise.resolve(t);const i=s.querySelector("textarea");if(null==i||this.isNullOrWhitespace(i.textContent))return t.errorMessage="Missing textarea.",t.success=!1,Promise.resolve(t);return JSON.parse(i.textContent).forEach((e=>{const s=this.initLoginCipher();if(this.isNullOrWhitespace(e.label)||(s.name=e.label.split(" ")[0]),null==e.data||this.isNullOrWhitespace(e.data.notes)||(s.notes=e.data.notes.split("\\n").join("\n")),null!=e.currentVersion&&null!=e.currentVersion.fields)for(const t in e.currentVersion.fields){if(!e.currentVersion.fields.hasOwnProperty(t))continue;const i=e.currentVersion.fields[t];switch(null!=i.actionType?i.actionType.toLowerCase():null){case"password":s.login.password=this.getValueOrDefault(i.value);break;case"email":case"username":case"user":case"name":s.login.username=this.getValueOrDefault(i.value);break;case"url":s.login.uris=this.makeUriArray(i.value);break;default:{const e=null!=i.label?i.label.toLowerCase():null;null==s.login.password&&this.passwordFieldNames.indexOf(e)>-1?s.login.password=this.getValueOrDefault(i.value):null==s.login.username&&this.usernameFieldNames.indexOf(e)>-1?s.login.username=this.getValueOrDefault(i.value):(null==s.login.uris||0===s.login.uris.length)&&this.uriFieldNames.indexOf(e)>-1?s.login.uris=this.makeUriArray(i.value):this.processKvp(s,i.label,i.value);break}}}this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t)}}class B extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{this.processFolder(t,this.getValueOrDefault(e.Category));const s=this.initLoginCipher();s.favorite="True"===this.getValueOrDefault(e.Favorite),s.name=this.getValueOrDefault(e.Entry,"--"),s.notes=this.getValueOrDefault(e.Note),s.login.username=this.getValueOrDefault(e.Username,e.Email),s.login.password=this.getValueOrDefault(e.Password),s.login.totp=this.getValueOrDefault(e.TOTP),s.login.uris=this.makeUriArray(e.Website),this.isNullOrWhitespace(e.Username)||this.processKvp(s,"Email",e.Email),this.processKvp(s,"Phone",e.Phone),this.processKvp(s,"PIN",e.PIN),this.processKvp(s,"Account",e.Account),this.processKvp(s,"Date",e.Date),this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}}var R=s(60337),M=s(65893);const Y=new Set(["title","note","username","password","url","otpSecret","category"]),Q=new Set(["type","title","first_name","middle_name","last_name","login","email","phone_number","address","country","state","city","zip","item_name"]),J=new Set(["title","note"]);class z extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);if(null==s)return t.success=!1,Promise.resolve(t);if(null!=s[0].type&&null!=s[0].title){if(1===s.filter((e=>"name"===e.type)).length){const e=this.initLoginCipher();return e.type=i.O.Identity,e.identity=new M.t,s.forEach((t=>{this.parsePersonalInformationRecordAsIdentity(e,t)})),this.cleanupCipher(e),t.ciphers.push(e),t.success=!0,Promise.resolve(t)}}return s.forEach((e=>{const s=this.initLoginCipher(),i=Object.keys(e);"username"===i[0]&&(this.processFolder(t,e.category),this.parseCredentialsRecord(s,e)),"type"===i[0]&&"account_name"===i[1]&&this.parsePaymentRecord(s,e),"type"===i[0]&&"number"===i[1]&&this.parseIdRecord(s,e),"type"===i[0]!=null&&"title"===i[1]&&this.parsePersonalInformationRecord(s,e),"title"===i[0]&&"note"===i[1]&&this.parseSecureNoteRecords(s,e),this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t)}parseCredentialsRecord(e,t){e.type=i.O.Login,e.login=new g.q,e.name=t.title,e.notes=t.note,e.login.username=t.username,e.login.password=t.password,e.login.totp=t.otpSecret,e.login.uris=this.makeUriArray(t.url),this.importUnmappedFields(e,t,Y)}parsePaymentRecord(e,t){e.type=i.O.Card,e.card=new R._,e.name=t.account_name;let s=[];switch(t.type){case"credit_card":e.card.cardholderName=t.account_name,e.card.number=t.cc_number,e.card.brand=this.getCardBrand(e.card.number),e.card.code=t.code,e.card.expMonth=t.expiration_month,e.card.expYear=t.expiration_year.substring(2,4),s=["account_name","account_holder","cc_number","code","expiration_month","expiration_year"];break;case"bank":e.card.cardholderName=t.account_holder,e.card.number=t.account_number,s=["account_name","account_holder","account_number"]}this.importUnmappedFields(e,t,new Set(s))}parseIdRecord(e,t){e.type=i.O.Identity,e.identity=new M.t;const s=["name","number"];switch(t.type){case"card":e.name=`${t.name} ${t.type}`,this.processFullName(e,t.name),e.identity.licenseNumber=t.number;break;case"passport":e.name=`${t.name} ${t.type}`,this.processFullName(e,t.name),e.identity.passportNumber=t.number;break;case"license":e.name=`${t.name} ${t.type}`,this.processFullName(e,t.name),e.identity.licenseNumber=t.number,e.identity.state=t.state,s.push("state");break;case"social_security":e.name=`${t.name} ${t.type}`,this.processFullName(e,t.name),e.identity.ssn=t.number;break;case"tax_number":e.name=t.type,e.identity.licenseNumber=t.number}this.importUnmappedFields(e,t,new Set(s))}parsePersonalInformationRecord(e,t){e.type=i.O.SecureNote,e.secureNote.type=c.x.Generic,"name"===t.type?e.name=`${t.title} ${t.first_name} ${t.middle_name} ${t.last_name}`.replace("  "," ").trim():e.name=t.item_name;const s=t;Object.keys(t).forEach((t=>{this.processKvp(e,t,s[t])}))}parsePersonalInformationRecordAsIdentity(e,t){switch(t.type){case"name":this.processFullName(e,`${t.first_name} ${t.middle_name} ${t.last_name}`),e.identity.title=t.title,e.name=e.identity.fullName,e.identity.username=t.login;break;case"email":e.identity.email=t.email;break;case"number":e.identity.phone=t.phone_number;break;case"address":e.identity.address1=t.address,e.identity.city=t.city,e.identity.postalCode=t.zip,e.identity.state=t.state,e.identity.country=t.country}this.importUnmappedFields(e,t,Q)}parseSecureNoteRecords(e,t){e.type=i.O.SecureNote,e.secureNote.type=c.x.Generic,e.name=t.title,e.notes=t.note,this.importUnmappedFields(e,t,J)}importUnmappedFields(e,t,s){Object.keys(t).filter((e=>!s.has(e))).forEach((s=>{const i=t;this.processKvp(e,s,i[s])}))}}const j=new Set(["ADDRESS","AUTHENTIFIANT","BANKSTATEMENT","IDCARD","IDENTITY","PAYMENTMEANS_CREDITCARD","PAYMENTMEAN_PAYPAL","EMAIL"]);class K extends w{parse(e){this.result=new o;const t=JSON.parse(e);if(null==t||0===t.length)return this.result.success=!1,Promise.resolve(this.result);null!=t.ADDRESS&&this.processAddress(t.ADDRESS),null!=t.AUTHENTIFIANT&&this.processAuth(t.AUTHENTIFIANT),null!=t.BANKSTATEMENT&&this.processNote(t.BANKSTATEMENT,"BankAccountName"),null!=t.IDCARD&&this.processNote(t.IDCARD,"Fullname"),null!=t.PAYMENTMEANS_CREDITCARD&&this.processCard(t.PAYMENTMEANS_CREDITCARD),null!=t.IDENTITY&&this.processIdentity(t.IDENTITY);for(const s in t)t.hasOwnProperty(s)&&!j.has(s)&&this.processNote(t[s],null,"Generic Note");return this.result.success=!0,Promise.resolve(this.result)}processAuth(e){e.forEach((e=>{const t=this.initLoginCipher();t.name=this.getValueOrDefault(e.title),t.login.username=this.getValueOrDefault(e.login,this.getValueOrDefault(e.secondaryLogin)),this.isNullOrWhitespace(t.login.username)?t.login.username=this.getValueOrDefault(e.email):this.isNullOrWhitespace(e.email)||(t.notes="Email: "+e.email+"\n"),t.login.password=this.getValueOrDefault(e.password),t.login.uris=this.makeUriArray(e.domain),t.notes+=this.getValueOrDefault(e.note,""),this.convertToNoteIfNeeded(t),this.cleanupCipher(t),this.result.ciphers.push(t)}))}processIdentity(e){e.forEach((e=>{const t=new p.$;t.identity=new M.t,t.type=i.O.Identity,t.name=this.getValueOrDefault(e.fullName,"");const s=t.name.split(" ");s.length>0&&(t.identity.firstName=this.getValueOrDefault(s[0])),2===s.length?t.identity.lastName=this.getValueOrDefault(s[1]):3===s.length&&(t.identity.middleName=this.getValueOrDefault(s[1]),t.identity.lastName=this.getValueOrDefault(s[2])),t.identity.username=this.getValueOrDefault(e.pseudo),this.cleanupCipher(t),this.result.ciphers.push(t)}))}processAddress(e){e.forEach((e=>{const t=new p.$;t.identity=new M.t,t.type=i.O.Identity,t.name=this.getValueOrDefault(e.addressName),t.identity.address1=this.getValueOrDefault(e.addressFull),t.identity.city=this.getValueOrDefault(e.city),t.identity.state=this.getValueOrDefault(e.state),t.identity.postalCode=this.getValueOrDefault(e.zipcode),t.identity.country=this.getValueOrDefault(e.country),null!=t.identity.country&&(t.identity.country=t.identity.country.toUpperCase()),this.cleanupCipher(t),this.result.ciphers.push(t)}))}processCard(e){e.forEach((e=>{const t=new p.$;t.card=new R._,t.type=i.O.Card,t.name=this.getValueOrDefault(e.bank),t.card.number=this.getValueOrDefault(e.cardNumber),t.card.brand=this.getCardBrand(t.card.number),t.card.cardholderName=this.getValueOrDefault(e.owner),this.isNullOrWhitespace(t.card.brand)||(this.isNullOrWhitespace(t.name)?t.name=t.card.brand:t.name+=" - "+t.card.brand),this.cleanupCipher(t),this.result.ciphers.push(t)}))}processNote(e,t,s=null){e.forEach((e=>{const r=new p.$;r.secureNote=new y.z,r.type=i.O.SecureNote,r.secureNote.type=c.x.Generic,r.name=null!=s?s:this.getValueOrDefault(e[t]);for(const s in e)e.hasOwnProperty(s)&&s!==t&&this.processKvp(r,s,e[s].toString());this.cleanupCipher(r),this.result.ciphers.push(r)}))}}class H extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.Label,"--"),s.notes=this.getValueOrDefault(e.Notes);const r=this.getValueOrDefault(e.Text);this.isNullOrWhitespace(r)||(this.isNullOrWhitespace(s.notes)?s.notes=r:s.notes+="\n\n"+r);const n=e["Entry Type"];if("Password"===n)s.login.username=this.getValueOrDefault(e.Username),s.login.password=this.getValueOrDefault(e.Password),s.login.uris=this.makeUriArray(e["Site URL"]);else if("Credit Card"===n){s.type=i.O.Card,s.card=new R._,s.card.cardholderName=this.getValueOrDefault(e["Name on card"]),s.card.number=this.getValueOrDefault(e["Card Number"]),s.card.brand=this.getCardBrand(s.card.number),s.card.code=this.getValueOrDefault(e.CVV);const t=this.getValueOrDefault(e.Expiry);if(!this.isNullOrWhitespace(t)){const e=t.split("/");e.length>1&&(s.card.expMonth=parseInt(e[0],null).toString(),s.card.expYear=(2e3+parseInt(e[1],null)).toString())}}this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class G extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);if(null==s)return t.success=!1,Promise.resolve(t);let r=!0;return s.forEach((e=>{if(e.length<2||r&&("Title"===e[0]||"title"===e[0]))return void(r=!1);const s=this.initLoginCipher();if(s.notes=this.getValueOrDefault(e[e.length-1]),s.name=this.getValueOrDefault(e[0],"--"),2!==e.length&&(this.containsField(e,"username")||this.containsField(e,"password")||this.containsField(e,"email")||this.containsField(e,"url"))||(s.type=i.O.SecureNote,s.secureNote=new y.z,s.secureNote.type=c.x.Generic),this.containsField(e,"cardholder")&&this.containsField(e,"number")&&this.containsField(e,"expiry date")&&(s.type=i.O.Card,s.card=new R._),e.length>2&&e.length%2==0)for(let t=0;t<e.length-2;t+=2){const r=e[t+2];if(this.isNullOrWhitespace(r))continue;const n=e[t+1],o=n.toLowerCase();if(s.type===i.O.Login){if("url"===o&&(null==s.login.uris||0===s.login.uris.length)){s.login.uris=this.makeUriArray(r);continue}if(("username"===o||"email"===o)&&this.isNullOrWhitespace(s.login.username)){s.login.username=r;continue}if("password"===o&&this.isNullOrWhitespace(s.login.password)){s.login.password=r;continue}if("totp"===o&&this.isNullOrWhitespace(s.login.totp)){s.login.totp=r;continue}}else if(s.type===i.O.Card){if("cardholder"===o&&this.isNullOrWhitespace(s.card.cardholderName)){s.card.cardholderName=r;continue}if("number"===o&&this.isNullOrWhitespace(s.card.number)){s.card.number=r,s.card.brand=this.getCardBrand(r);continue}if("cvc"===o&&this.isNullOrWhitespace(s.card.code)){s.card.code=r;continue}if("expiry date"===o&&this.isNullOrWhitespace(s.card.expMonth)&&this.isNullOrWhitespace(s.card.expYear)){if(this.setCardExpiration(s,r))continue}else if("type"===o)continue}this.processKvp(s,n,r)}this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t)}containsField(e,t){return null!=e&&null!=t&&e.filter((e=>!this.isNullOrWhitespace(e)&&e.toLowerCase()===t.toLowerCase())).length>0}}class $ extends w{parse(e){const t=new o,s=JSON.parse(e);if(null==s||null==s.items||0===s.items.length)return t.success=!1,Promise.resolve(t);const i=new Map,r=new Map,n=this.buildFolderTree(s.folders);return this.flattenFolderTree(null,n,i),i.forEach(((e,s)=>{r.set(s,t.folders.length);const i=new m.a;i.name=e,t.folders.push(i)})),s.items.forEach((e=>{null!=e.folders&&e.folders.length>0&&r.has(e.folders[0])&&t.folderRelationships.push([t.ciphers.length,r.get(e.folders[0])]);const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.title),s.favorite=e.favorite>0,null!=e.template_type&&null!=e.fields&&e.fields.length>0&&(0===e.template_type.indexOf("login.")||0===e.template_type.indexOf("password.")?this.processLogin(s,e.fields):0===e.template_type.indexOf("creditcard.")?this.processCard(s,e.fields):e.template_type.indexOf("identity.")<0&&e.fields.some((e=>"password"===e.type&&!this.isNullOrWhitespace(e.value)))?this.processLogin(s,e.fields):this.processNote(s,e.fields)),s.notes+="\n"+this.getValueOrDefault(e.note,""),this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t)}processLogin(e,t){const s=[];t.forEach((t=>{this.isNullOrWhitespace(t.value)||"section"===t.type||("username"!==t.type&&"email"!==t.type||!this.isNullOrWhitespace(e.login.username)?"password"===t.type&&this.isNullOrWhitespace(e.login.password)?e.login.password=t.value:"totp"===t.type&&this.isNullOrWhitespace(e.login.totp)?e.login.totp=t.value:"url"===t.type?s.push(t.value):this.processKvp(e,t.label,t.value,1===t.sensitive?l.f.Hidden:l.f.Text):e.login.username=t.value)})),e.login.uris=this.makeUriArray(s)}processCard(e,t){e.card=new R._,e.type=i.O.Card,t.forEach((t=>{this.isNullOrWhitespace(t.value)||"section"===t.type||"ccType"===t.type||("ccName"===t.type&&this.isNullOrWhitespace(e.card.cardholderName)?e.card.cardholderName=t.value:"ccNumber"===t.type&&this.isNullOrWhitespace(e.card.number)?(e.card.number=t.value,e.card.brand=this.getCardBrand(e.card.number)):"ccCvc"===t.type&&this.isNullOrWhitespace(e.card.code)?e.card.code=t.value:"ccExpiry"===t.type&&this.isNullOrWhitespace(e.card.expYear)&&this.setCardExpiration(e,t.value)||this.processKvp(e,t.label,t.value,1===t.sensitive?l.f.Hidden:l.f.Text))}))}processNote(e,t){t.forEach((t=>{this.isNullOrWhitespace(t.value)||"section"===t.type||this.processKvp(e,t.label,t.value,1===t.sensitive?l.f.Hidden:l.f.Text)}))}buildFolderTree(e){if(null==e)return[];const t=[],s=new Map([]);return e.forEach((e=>{s.set(e.uuid,e),e.children=[]})),e.forEach((e=>{null!=e.parent_uuid&&""!==e.parent_uuid&&s.has(e.parent_uuid)?s.get(e.parent_uuid).children.push(e):t.push(e)})),t}flattenFolderTree(e,t,s){null!=t&&t.forEach((t=>{if(null!=t.title&&""!==t.title.trim()){let i=t.title.trim();null!=e&&""!==e.trim()&&(i=e+"/"+i),s.set(t.uuid,i),null!=t.children&&0!==t.children.length&&this.flattenFolderTree(i,t.children,s)}}))}}class X extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.filter((e=>"chrome://FirefoxAccounts"!==e.url)).forEach((e=>{const s=this.initLoginCipher(),i=this.getValueOrDefault(e.url,this.getValueOrDefault(e.hostname));s.name=this.getValueOrDefault(this.nameFromUrl(i),"--"),s.login.username=this.getValueOrDefault(e.username),s.login.password=this.getValueOrDefault(e.password),s.login.uris=this.makeUriArray(i),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class ee extends w{parse(e){const t=new o,s=JSON.parse(e);if(null==s||null==s.data)return t.success=!1,Promise.resolve(t);for(const r in s.data){if(!s.data.hasOwnProperty(r))continue;const e=s.data[r],n=this.initLoginCipher();if(n.name=this.getValueOrDefault(e.service),n.notes=this.getValueOrDefault(e.notes),"website"===e.style||"globe"===e.style)n.login.username=this.getValueOrDefault(e.username),n.login.password=this.getValueOrDefault(e.password),n.login.uris=this.makeUriArray(e.url);else{if("creditcard"!==e.style)continue;n.type=i.O.Card,n.card=new R._,n.card.cardholderName=this.getValueOrDefault(e.username),n.card.number=this.getValueOrDefault(e.creditNumber),n.card.brand=this.getCardBrand(n.card.number),n.card.code=this.getValueOrDefault(e.creditCvv),this.isNullOrWhitespace(e.creditExpiry)||this.setCardExpiration(n,e.creditExpiry)||this.processKvp(n,"Expiration",e.creditExpiry),this.isNullOrWhitespace(e.password)||this.processKvp(n,"PIN",e.password)}this.convertToNoteIfNeeded(n),this.cleanupCipher(n),t.ciphers.push(n)}return t.success=!0,Promise.resolve(t)}}class te extends w{parse(e){const t=new o,s=JSON.parse(e);if(null==s||0===Object.keys(s).length)return t.success=!1,Promise.resolve(t);for(const i in s)s.hasOwnProperty(i)&&!this.isNullOrWhitespace(i)&&0!==s[i].length&&s[i].forEach((e=>{if(this.isNullOrWhitespace(e.display_name)||0!==e.display_name.indexOf("http"))return;this.processFolder(t,i);const s=this.initLoginCipher();if(s.name=e.display_name.replace("http://","").replace("https://",""),s.name.length>30&&(s.name=s.name.substring(0,30)),s.login.password=this.getValueOrDefault(e.secret),s.login.uris=this.makeUriArray(e.display_name),null!=e.attributes){s.login.username=null!=e.attributes?this.getValueOrDefault(e.attributes.username_value):null;for(const t in e.attributes)e.attributes.hasOwnProperty(t)&&"username_value"!==t&&"xdg:schema"!==t&&this.processKvp(s,t,e.attributes[t])}this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)}));return this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t)}}class se extends Error{constructor(e,t=!1){super(e),this.passwordRequired=t}}const ie="Notes\n\n",re="Applications\n\n",ne="Websites\n\n",oe="\n---\n";class ae extends w{parse(e){const t=new o;let s,i,r,n=this.splitNewLine(e).join("\n");if(-1!==n.indexOf(ie)){const e=n.split(ie);e.length>1&&(n=e[0],s=e[1])}if(-1!==n.indexOf(re)){const e=n.split(re);e.length>1&&(n=e[0],i=e[1])}if(0===n.indexOf(ne)){const e=n.split(ne);e.length>1&&(n=e[0],r=e[1])}const a=this.parseDataCategory(s),l=this.parseDataCategory(i),c=this.parseDataCategory(r);return a.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.get("Name")),s.notes=this.getValueOrDefault(e.get("Text")),this.cleanupCipher(s),t.ciphers.push(s)})),c.concat(l).forEach((e=>{const s=this.initLoginCipher(),i=e.has("Website name")?"Website name":"Application";s.name=this.getValueOrDefault(e.get(i),""),this.isNullOrWhitespace(e.get("Login name"))||(this.isNullOrWhitespace(s.name)||(s.name+=": "),s.name+=e.get("Login name")),s.notes=this.getValueOrDefault(e.get("Comment")),e.has("Website URL")&&(s.login.uris=this.makeUriArray(e.get("Website URL"))),s.login.username=this.getValueOrDefault(e.get("Login")),s.login.password=this.getValueOrDefault(e.get("Password")),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t)}parseDataCategory(e){if(this.isNullOrWhitespace(e)||-1===e.indexOf(oe))return[];const t=[];return e.split(oe).forEach((e=>{if(-1===e.indexOf("\n"))return;const s=new Map;let i,r;e.split("\n").forEach((e=>{if(null!=i)return void(i+="\n"+e);const t=e.indexOf(":");let n,o;-1!==t&&(n=e.substring(0,t),e.length>t+1&&(o=e.substring(t+2)),null!=n&&s.set(n,o),"Comment"!==n&&"Text"!==n||(i=o,r=n))})),null!=i&&null!=r&&s.set(r,i),0!==s.size&&t.push(s)})),t}}class le extends w{constructor(){super(...arguments),this.result=new o}parse(e){const t=this.parseXml(e);if(null==t)return this.result.success=!1,Promise.resolve(this.result);const s=t.querySelector("KeePassFile > Root > Group");return null==s?(this.result.errorMessage="Missing `KeePassFile > Root > Group` node.",this.result.success=!1,Promise.resolve(this.result)):(this.traverse(s,!0,""),this.organization&&this.moveFoldersToCollections(this.result),this.result.success=!0,Promise.resolve(this.result))}traverse(e,t,s){const i=this.result.folders.length;let r=s;if(!t){""!==r&&(r+="/");const t=this.querySelectorDirectChild(e,"Name");r+=null==t?"-":t.textContent;const s=new m.a;s.name=r,this.result.folders.push(s)}this.querySelectorAllDirectChild(e,"Entry").forEach((e=>{const s=this.result.ciphers.length,r=this.initLoginCipher();this.querySelectorAllDirectChild(e,"String").forEach((e=>{const t=this.querySelectorDirectChild(e,"Value"),s=null!=t?t.textContent:null;if(this.isNullOrWhitespace(s))return;const i=this.querySelectorDirectChild(e,"Key"),n=null!=i?i.textContent:null;if("URL"===n)r.login.uris=this.makeUriArray(s);else if("UserName"===n)r.login.username=s;else if("Password"===n)r.login.password=s;else if("otp"===n)r.login.totp=s.replace("key=","");else if("Title"===n)r.name=s;else if("Notes"===n)r.notes+=s+"\n";else{let e=l.f.Text;const i=t.attributes;i.length>0&&null!=i.ProtectInMemory&&"True"===i.ProtectInMemory.value&&(e=l.f.Hidden),this.processKvp(r,n,s,e)}})),this.cleanupCipher(r),this.result.ciphers.push(r),t||this.result.folderRelationships.push([s,i])})),this.querySelectorAllDirectChild(e,"Group").forEach((e=>{this.traverse(e,!1,r)}))}}class ce extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(this.isNullOrWhitespace(e.Title))return;e.Group=!this.isNullOrWhitespace(e.Group)&&e.Group.startsWith("Root/")?e.Group.replace("Root/",""):e.Group;const s=this.isNullOrWhitespace(e.Group)?null:e.Group;this.processFolder(t,s);const i=this.initLoginCipher();i.notes=this.getValueOrDefault(e.Notes),i.name=this.getValueOrDefault(e.Title,"--"),i.login.username=this.getValueOrDefault(e.Username),i.login.password=this.getValueOrDefault(e.Password),i.login.uris=this.makeUriArray(e.URL),this.cleanupCipher(i),t.ciphers.push(i)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}}class ue extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(e.length<6)return;this.processFolder(t,e[0]);const s=this.initLoginCipher();if(s.notes=this.getValueOrDefault(e[5])+"\n",s.name=this.getValueOrDefault(e[1],"--"),s.login.username=this.getValueOrDefault(e[2]),s.login.password=this.getValueOrDefault(e[3]),s.login.uris=this.makeUriArray(e[4]),e.length>7)for(let t=7;t<e.length;t+=2)this.processKvp(s,e[t],e[t+1]);this.cleanupCipher(s),t.ciphers.push(s)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}}class pe extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=t.ciphers.length;let r=t.folders.length,n=e.grouping;null!=n&&(n=n.replace(/\\/g,"/").replace(/[\x00-\x1F\x7F-\x9F]/g,""));const o="(none)"!==this.getValueOrDefault(n,"(none)");let a=o;if(o)for(let i=0;i<t.folders.length;i++)if(t.folders[i].name===n){a=!1,r=i;break}const l=this.buildBaseCipher(e);if(l.type===i.O.Login)l.notes=this.getValueOrDefault(e.extra),l.login=new g.q,l.login.uris=this.makeUriArray(e.url),l.login.username=this.getValueOrDefault(e.username),l.login.password=this.getValueOrDefault(e.password),l.login.totp=this.getValueOrDefault(e.totp);else if(l.type===i.O.SecureNote)this.parseSecureNote(e,l);else if(l.type===i.O.Card)l.card=this.parseCard(e),l.notes=this.getValueOrDefault(e.notes);else if(l.type===i.O.Identity&&(l.identity=this.parseIdentity(e),l.notes=this.getValueOrDefault(e.notes),!this.isNullOrWhitespace(e.ccnum))){const s=this.buildBaseCipher(e);s.identity=null,s.type=i.O.Card,s.card=this.parseCard(e),t.ciphers.push(s)}if(t.ciphers.push(l),a){const e=new m.a;e.name=n,t.folders.push(e)}o&&t.folderRelationships.push([s,r])})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}buildBaseCipher(e){const t=new p.$;return e.hasOwnProperty("profilename")&&e.hasOwnProperty("profilelanguage")?(t.favorite=!1,t.name=this.getValueOrDefault(e.profilename,"--"),t.type=i.O.Card,this.isNullOrWhitespace(e.title)&&this.isNullOrWhitespace(e.firstname)&&this.isNullOrWhitespace(e.lastname)&&this.isNullOrWhitespace(e.address1)&&this.isNullOrWhitespace(e.phone)&&this.isNullOrWhitespace(e.username)&&this.isNullOrWhitespace(e.email)||(t.type=i.O.Identity)):(t.favorite=!this.organization&&"1"===this.getValueOrDefault(e.fav,"0"),t.name=this.getValueOrDefault(e.name,"--"),t.type="http://sn"===e.url?i.O.SecureNote:i.O.Login),t}parseCard(e){const t=new R._;if(t.cardholderName=this.getValueOrDefault(e.ccname),t.number=this.getValueOrDefault(e.ccnum),t.code=this.getValueOrDefault(e.cccsc),t.brand=this.getCardBrand(e.ccnum),!this.isNullOrWhitespace(e.ccexp)&&e.ccexp.indexOf("-")>-1){const s=e.ccexp.split("-");s.length>1&&(t.expYear=s[0],t.expMonth=s[1],2===t.expMonth.length&&"0"===t.expMonth[0]&&(t.expMonth=t.expMonth[1]))}return t}parseIdentity(e){const t=new M.t;return t.title=this.getValueOrDefault(e.title),t.firstName=this.getValueOrDefault(e.firstname),t.middleName=this.getValueOrDefault(e.middlename),t.lastName=this.getValueOrDefault(e.lastname),t.username=this.getValueOrDefault(e.username),t.company=this.getValueOrDefault(e.company),t.ssn=this.getValueOrDefault(e.ssn),t.address1=this.getValueOrDefault(e.address1),t.address2=this.getValueOrDefault(e.address2),t.address3=this.getValueOrDefault(e.address3),t.city=this.getValueOrDefault(e.city),t.state=this.getValueOrDefault(e.state),t.postalCode=this.getValueOrDefault(e.zip),t.country=this.getValueOrDefault(e.country),t.email=this.getValueOrDefault(e.email),t.phone=this.getValueOrDefault(e.phone),this.isNullOrWhitespace(t.title)||(t.title=t.title.charAt(0).toUpperCase()+t.title.slice(1)),t}parseSecureNote(e,t){const s=this.splitNewLine(e.extra);let r=!1;if(s.length){const e=s[0].split(":");if(e.length>1&&"NoteType"===e[0]&&("Credit Card"===e[1]||"Address"===e[1])){if("Credit Card"===e[1]){const e=this.parseSecureNoteMapping(t,s,{Number:"number","Name on Card":"cardholderName","Security Code":"code","Expiration Date":"expMonth"});if(this.isNullOrWhitespace(e.expMonth)||","===e.expMonth)e.expMonth=void 0;else{const[t,s]=e.expMonth.split(",");if(this.isNullOrWhitespace(t))e.expMonth=void 0;else{const s=new Date(Date.parse(t.trim()+" 1, 2012")).getMonth()+1;isNaN(s)?e.expMonth=void 0:e.expMonth=s.toString()}this.isNullOrWhitespace(s)||(e.expYear=s)}t.type=i.O.Card,t.card=e}else if("Address"===e[1]){const e=this.parseSecureNoteMapping(t,s,{Title:"title","First Name":"firstName","Last Name":"lastName","Middle Name":"middleName",Company:"company","Address 1":"address1","Address 2":"address2","Address 3":"address3","City / Town":"city",State:"state","Zip / Postal Code":"postalCode",Country:"country","Email Address":"email",Username:"username"});t.type=i.O.Identity,t.identity=e}r=!0}}r||(t.secureNote=new y.z,t.secureNote.type=c.x.Generic,t.notes=this.getValueOrDefault(e.extra))}parseSecureNoteMapping(e,t,s){const i={};let r=!1;return t.forEach((t=>{let n=null,o=null;if(!r){if(this.isNullOrWhitespace(t))return;const e=t.indexOf(":");if(-1===e?n=t:(n=t.substring(0,e),t.length>e&&(o=t.substring(e+1))),this.isNullOrWhitespace(n)||this.isNullOrWhitespace(o)||"NoteType"===n)return}r?e.notes+="\n"+t:"Notes"===n?(this.isNullOrWhitespace(e.notes)?e.notes=o:e.notes+="\n"+o,r=!0):s.hasOwnProperty(n)?i[s[n]]=o:this.processKvp(e,n,o)})),i}}class he extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(e.length<4)return;const s=this.initLoginCipher();s.name=this.getValueOrDefault(e[0],"--"),s.login.username=this.getValueOrDefault(e[2]),s.login.password=this.getValueOrDefault(e[3]),s.login.uris=this.makeUriArray(e[1]),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class de extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.DisplayName,"--"),s.notes=this.getValueOrDefault(e.Notes),s.login.username=this.getValueOrDefault(e.UserName),s.login.password=this.getValueOrDefault(e.Password),s.login.uris=this.makeUriArray(e.Url),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class me extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(e.length<3)return;const s="Unassigned"!==this.getValueOrDefault(e[0],"Unassigned")?e[0]:null;this.processFolder(t,s);const r=this.initLoginCipher();if(r.name=this.getValueOrDefault(e[2],"--"),"Web Logins"===e[1]||"Login"===e[1])r.login.uris=this.makeUriArray(e[4]),r.login.username=this.getValueOrDefault(e[5]),r.login.password=this.getValueOrDefault(e[6]),r.notes=this.isNullOrWhitespace(e[3])?null:e[3].split("\\n").join("\n");else if(e.length>3){r.type=i.O.SecureNote,r.secureNote=new y.z,r.secureNote.type=c.x.Generic;for(let t=3;t<e.length;t++)this.isNullOrWhitespace(e[t])||(r.notes+=e[t]+"\n")}this.isNullOrWhitespace(e[1])||r.type===i.O.Login||(r.name=e[1]+": "+r.name),this.cleanupCipher(r),t.ciphers.push(r)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}}const fe=["nickname","additionalInfo"],ge=new Set(fe.concat(["url","username","password","twofaSecret"])),ye=new Set(fe.concat(["cardNumber","cardName","exp_month","exp_year","cvv"])),ve=new Set(fe.concat(["title","firstName","middleName","lastName","email","firstAddressLine","secondAddressLine","city","country","zipCode"])),we=new Set(fe.concat(["idName","idNumber","idCountry"])),Oe=new Set(fe.concat(["authToken"])),xe=new Set(fe.concat(["content"]));class Ne extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();if(s.name=this.getValueOrDefault(e.nickname,"--"),s.notes=this.getValueOrDefault(e.additionalInfo),void 0!==e.url)s.login.uris=this.makeUriArray(e.url),s.login.username=this.getValueOrDefault(e.username),s.login.password=this.getValueOrDefault(e.password),s.login.totp=this.getValueOrDefault(e.twofaSecret),this.importUnmappedFields(s,e,ge);else if(void 0!==e.authToken)s.login.totp=this.getValueOrDefault(e.authToken),this.importUnmappedFields(s,e,Oe);else if(void 0!==e.cardNumber)s.card=new R._,s.type=i.O.Card,s.card.cardholderName=this.getValueOrDefault(e.cardName),s.card.number=this.getValueOrDefault(e.cardNumber),s.card.brand=this.getCardBrand(s.card.number),s.card.expMonth=this.getValueOrDefault(e.exp_month),s.card.expYear=this.getValueOrDefault(e.exp_year),s.card.code=this.getValueOrDefault(e.cvv),this.importUnmappedFields(s,e,ye);else if(void 0!==e.firstName)s.identity=new M.t,s.type=i.O.Identity,s.identity.title=this.getValueOrDefault(e.title),s.identity.firstName=this.getValueOrDefault(e.firstName),s.identity.middleName=this.getValueOrDefault(e.middleName),s.identity.lastName=this.getValueOrDefault(e.lastName),s.identity.phone=this.getValueOrDefault(e.number),s.identity.email=this.getValueOrDefault(e.email),s.identity.address1=this.getValueOrDefault(e.firstAddressLine),s.identity.address2=this.getValueOrDefault(e.secondAddressLine),s.identity.city=this.getValueOrDefault(e.city),s.identity.country=this.getValueOrDefault(e.country),s.identity.postalCode=this.getValueOrDefault(e.zipCode),this.importUnmappedFields(s,e,ve);else if(void 0!==e.idType){switch(s.identity=new M.t,s.type=i.O.Identity,this.processFullName(s,e.idName),s.identity.country=this.getValueOrDefault(e.idCountry),e.idType){case"Passport":s.identity.passportNumber=e.idNumber;break;case"Social Security":s.identity.ssn=e.idNumber;break;default:s.identity.licenseNumber=e.idNumber}this.importUnmappedFields(s,e,we)}else{if(void 0===e.content)return;s.secureNote=new y.z,s.type=i.O.SecureNote,s.secureNote.type=c.x.Generic,s.notes=this.getValueOrDefault(e.content),this.importUnmappedFields(s,e,xe)}this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}importUnmappedFields(e,t,s){Object.keys(t).filter((e=>!s.has(e))).forEach((s=>{const i=t;this.processKvp(e,s,i[s])}))}}class Ce extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.evaluateType(e);if(void 0===s)return;this.organization||this.processFolder(t,e.folder);const r=new p.$;switch(r.name=this.getValueOrDefault(e.name,"--"),r.notes=this.getValueOrDefault(e.note),s){case i.O.Login:r.type=i.O.Login,r.login=new g.q,r.login.username=this.getValueOrDefault(e.username),r.login.password=this.getValueOrDefault(e.password),r.login.uris=this.makeUriArray(e.url);break;case i.O.Card:r.type=i.O.Card,r.card.cardholderName=this.getValueOrDefault(e.cardholdername),r.card.number=this.getValueOrDefault(e.cardnumber),r.card.code=this.getValueOrDefault(e.cvc),r.card.brand=this.getCardBrand(r.card.number),this.setCardExpiration(r,e.expirydate);break;case i.O.Identity:r.type=i.O.Identity,this.processFullName(r,this.getValueOrDefault(e.full_name)),r.identity.address1=this.getValueOrDefault(e.address1),r.identity.address2=this.getValueOrDefault(e.address2),r.identity.city=this.getValueOrDefault(e.city),r.identity.state=this.getValueOrDefault(e.state),r.identity.postalCode=this.getValueOrDefault(e.zipcode),r.identity.country=this.getValueOrDefault(e.country),null!=r.identity.country&&(r.identity.country=r.identity.country.toUpperCase()),r.identity.email=this.getValueOrDefault(e.email),r.identity.phone=this.getValueOrDefault(e.phone_number);break;case i.O.SecureNote:r.type=i.O.SecureNote,r.secureNote.type=c.x.Generic}this.cleanupCipher(r),t.ciphers.push(r)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}evaluateType(e){return this.isNullOrWhitespace(e.username)?this.isNullOrWhitespace(e.cardnumber)?this.isNullOrWhitespace(e.full_name)?this.isNullOrWhitespace(e.note)?void 0:i.O.SecureNote:i.O.Identity:i.O.Card:i.O.Login}}var be,Ue,_e=s(42078);class De extends w{constructor(){super(...arguments),this.result=new o}parse(e){return e.split(this.newLineRegex).forEach((e=>{if(this.isNullOrWhitespace(e)||"{"!==e[0])return;const t=JSON.parse(e);if(!0===t.trashed)return;const s=this.initLoginCipher();this.isNullOrWhitespace(t.hmac)?this.processStandardItem(t,s):this.processWinOpVaultItem(t,s),this.convertToNoteIfNeeded(s),this.cleanupCipher(s),this.result.ciphers.push(s)})),this.result.success=!0,Promise.resolve(this.result)}processWinOpVaultItem(e,t){if(null!=e.overview&&(t.name=this.getValueOrDefault(e.overview.title),null!=e.overview.URLs)){const s=[];e.overview.URLs.forEach((e=>{this.isNullOrWhitespace(e.u)||s.push(e.u)})),t.login.uris=this.makeUriArray(s)}null!=e.details&&(null!=e.details.passwordHistory&&this.parsePasswordHistory(e.details.passwordHistory,t),this.isNullOrWhitespace(e.details.ccnum)&&this.isNullOrWhitespace(e.details.cvv)?this.isNullOrWhitespace(e.details.firstname)&&this.isNullOrWhitespace(e.details.address1)||(t.type=i.O.Identity,t.identity=new M.t):(t.type=i.O.Card,t.card=new R._),t.type!==i.O.Login||this.isNullOrWhitespace(e.details.password)||(t.login.password=e.details.password),this.isNullOrWhitespace(e.details.notesPlain)||(t.notes=e.details.notesPlain.split(this.newLineRegex).join("\n")+"\n"),null!=e.details.fields&&this.parseFields(e.details.fields,t,"designation","value","name"),null!=e.details.sections&&e.details.sections.forEach((e=>{null!=e.fields&&this.parseFields(e.fields,t,"n","v","t")})))}processStandardItem(e,t){if(t.favorite=!(!e.openContents||!e.openContents.faveIndex),t.name=this.getValueOrDefault(e.title),"securenotes.SecureNote"===e.typeName?(t.type=i.O.SecureNote,t.secureNote=new y.z,t.secureNote.type=c.x.Generic):"wallet.financial.CreditCard"===e.typeName?(t.type=i.O.Card,t.card=new R._):"identities.Identity"===e.typeName?(t.type=i.O.Identity,t.identity=new M.t):t.login.uris=this.makeUriArray(e.location),null!=e.secureContents){if(null!=e.secureContents.passwordHistory&&this.parsePasswordHistory(e.secureContents.passwordHistory,t),this.isNullOrWhitespace(e.secureContents.notesPlain)||(t.notes=e.secureContents.notesPlain.split(this.newLineRegex).join("\n")+"\n"),t.type===i.O.Login&&(this.isNullOrWhitespace(e.secureContents.password)||(t.login.password=e.secureContents.password),null!=e.secureContents.URLs)){const s=[];e.secureContents.URLs.forEach((e=>{this.isNullOrWhitespace(e.url)||s.push(e.url)})),s.length>0&&(t.login.uris=this.makeUriArray(s))}null!=e.secureContents.fields&&this.parseFields(e.secureContents.fields,t,"designation","value","name"),null!=e.secureContents.sections&&e.secureContents.sections.forEach((e=>{null!=e.fields&&this.parseFields(e.fields,t,"n","v","t")}))}}parsePasswordHistory(e,t){const s=e.length>5?5:e.length;t.passwordHistory=e.filter((e=>!this.isNullOrWhitespace(e.value)&&null!=e.time)).sort(((e,t)=>t.time-e.time)).slice(0,s).map((e=>{const t=new _e.i;return t.password=e.value,t.lastUsedDate=new Date((""+e.time).length>=13?e.time:1e3*e.time),t}))}parseFields(e,t,s,r,n){e.forEach((e=>{if(null==e[r]||""===e[r].toString().trim())return;const o="date"===e.k?new Date(1e3*e[r]).toUTCString():e[r].toString(),a=null!=e[s]?e[s].toString():null;if(t.type===i.O.Login){if(this.isNullOrWhitespace(t.login.username)&&"username"===a)return void(t.login.username=o);if(this.isNullOrWhitespace(t.login.password)&&"password"===a)return void(t.login.password=o);if(this.isNullOrWhitespace(t.login.totp)&&null!=a&&a.startsWith("TOTP_"))return void(t.login.totp=o)}else if(t.type===i.O.Card){if(this.isNullOrWhitespace(t.card.number)&&"ccnum"===a)return t.card.number=o,void(t.card.brand=this.getCardBrand(o));if(this.isNullOrWhitespace(t.card.code)&&"cvv"===a)return void(t.card.code=o);if(this.isNullOrWhitespace(t.card.cardholderName)&&"cardholder"===a)return void(t.card.cardholderName=o);if(this.isNullOrWhitespace(t.card.expiration)&&"expiry"===a&&6===o.length)return t.card.expMonth=o.substr(4,2),"0"===t.card.expMonth[0]&&(t.card.expMonth=t.card.expMonth.substr(1,1)),void(t.card.expYear=o.substr(0,4));if("type"===a)return}else if(t.type===i.O.Identity){const s=t.identity;if(this.isNullOrWhitespace(s.firstName)&&"firstname"===a)return void(s.firstName=o);if(this.isNullOrWhitespace(s.lastName)&&"lastname"===a)return void(s.lastName=o);if(this.isNullOrWhitespace(s.middleName)&&"initial"===a)return void(s.middleName=o);if(this.isNullOrWhitespace(s.phone)&&"defphone"===a)return void(s.phone=o);if(this.isNullOrWhitespace(s.company)&&"company"===a)return void(s.company=o);if(this.isNullOrWhitespace(s.email)&&"email"===a)return void(s.email=o);if(this.isNullOrWhitespace(s.username)&&"username"===a)return void(s.username=o);if("address"===a){const{street:t,city:i,country:n,zip:o}=e[r];return s.address1=this.getValueOrDefault(t),s.city=this.getValueOrDefault(i),this.isNullOrWhitespace(n)||(s.country=n.toUpperCase()),void(s.postalCode=this.getValueOrDefault(o))}}const c=this.isNullOrWhitespace(e[n])?"no_name":e[n];if("password"===c&&null!=t.passwordHistory&&t.passwordHistory.some((e=>e.password===o)))return;const u="concealed"===e.k?l.f.Hidden:l.f.Text;this.processKvp(t,c,o,u)}))}}!function(e){e.Login="001",e.CreditCard="002",e.SecureNote="003",e.Identity="004",e.Password="005",e.Document="006",e.SoftwareLicense="100",e.BankAccount="101",e.Database="102",e.DriversLicense="103",e.OutdoorLicense="104",e.Membership="105",e.Passport="106",e.RewardsProgram="107",e.SocialSecurityNumber="108",e.WirelessRouter="109",e.Server="110",e.EmailAccount="111",e.API_Credential="112",e.MedicalRecord="113"}(be||(be={})),function(e){e.TextOrHtml="T",e.EmailAddress="E",e.URL="U",e.Number="N",e.Password="P",e.TextArea="A",e.PhoneNumber="T",e.CheckBox="C"}(Ue||(Ue={}));class Pe extends w{constructor(){super(...arguments),this.result=new o}parse(e){return JSON.parse(e).accounts[0].vaults.forEach((e=>{e.items.forEach((e=>{if(!0===e.trashed)return;const t=this.initLoginCipher(),s=e.categoryUuid;switch(s){case be.Login:case be.Database:case be.Password:case be.WirelessRouter:case be.Server:case be.API_Credential:t.type=i.O.Login,t.login=new g.q;break;case be.CreditCard:case be.BankAccount:t.type=i.O.Card,t.card=new R._;break;case be.SecureNote:case be.SoftwareLicense:case be.EmailAccount:case be.MedicalRecord:t.type=i.O.SecureNote,t.secureNote=new y.z,t.secureNote.type=c.x.Generic;break;case be.Identity:case be.DriversLicense:case be.OutdoorLicense:case be.Membership:case be.Passport:case be.RewardsProgram:case be.SocialSecurityNumber:t.type=i.O.Identity,t.identity=new M.t}t.favorite=1===e.favIndex,this.processOverview(e.overview,t),this.processLoginFields(e,t),this.processDetails(s,e.details,t),this.parsePasswordHistory(e.details.passwordHistory,t),this.processSections(s,e.details.sections,t),this.isNullOrWhitespace(e.details.notesPlain)||(t.notes=e.details.notesPlain.split(this.newLineRegex).join("\n")+"\n"),this.convertToNoteIfNeeded(t),this.cleanupCipher(t),this.result.ciphers.push(t)}))})),this.organization&&this.moveFoldersToCollections(this.result),this.result.success=!0,Promise.resolve(this.result)}processOverview(e,t){if(null!=e){if(t.name=this.getValueOrDefault(e.title),null!=e.urls){const s=[];e.urls.forEach((e=>{this.isNullOrWhitespace(e.url)||s.push(e.url)})),t.login.uris=this.makeUriArray(s)}if(null!=e.tags&&e.tags.length>0){const t=this.capitalize(e.tags[0]);this.processFolder(this.result,t)}}}capitalize(e){return e.trim().replace(/\w\S*/g,(e=>e.replace(/^\w/,(e=>e.toUpperCase()))))}processLoginFields(e,t){null!=e.details&&null!=e.details.loginFields&&0!==e.details.loginFields.length&&e.details.loginFields.forEach((e=>{if("username"===e.designation&&""!==e.value)return t.type=i.O.Login,void(t.login.username=e.value);if("password"===e.designation&&""!==e.value)return t.type=i.O.Login,void(t.login.password=e.value);let s=e.value,r=l.f.Text;switch(e.fieldType){case Ue.Password:r=l.f.Hidden;break;case Ue.CheckBox:s=""!==e.value?"true":"false",r=l.f.Boolean}this.processKvp(t,e.name,s,r)}))}processDetails(e,t,s){e===be.Password&&null!=t&&(s.login.password=t.password)}processSections(e,t,s){null!=t&&0!==t.length&&t.forEach((t=>{null!=t.fields&&this.parseSectionFields(e,t.fields,s)}))}parseSectionFields(e,t,s){t.forEach((t=>{const r=Object.keys(t.value)[0],n=t;if(null==n.value||null==n.value[r]||""===n.value[r])return;const o=this.getFieldName(t.id,t.title),a=this.extractValue(t.value,r);if(s.type===i.O.Login){if(this.fillLogin(t,a,s))return;switch(e){case be.Login:case be.Database:case be.EmailAccount:case be.WirelessRouter:break;case be.Server:if(this.isNullOrWhitespace(s.login.uri)&&"url"===t.id)return void(s.login.uris=this.makeUriArray(a));break;case be.API_Credential:if(this.fillApiCredentials(t,a,s))return}}else if(s.type===i.O.Card){if(this.fillCreditCard(t,a,s))return;if(e===be.BankAccount&&this.fillBankAccount(t,a,s))return}else if(s.type===i.O.Identity){if(this.fillIdentity(t,a,s,r))return;if("address"===r){const{street:e,city:i,country:r,zip:n,state:o}=t.value.address;return s.identity.address1=this.getValueOrDefault(e),s.identity.city=this.getValueOrDefault(i),this.isNullOrWhitespace(r)||(s.identity.country=r.toUpperCase()),s.identity.postalCode=this.getValueOrDefault(n),void(s.identity.state=this.getValueOrDefault(o))}switch(e){case be.Identity:break;case be.DriversLicense:if(this.fillDriversLicense(t,a,s))return;break;case be.OutdoorLicense:if(this.fillOutdoorLicense(t,a,s))return;break;case be.Membership:if(this.fillMembership(t,a,s))return;break;case be.Passport:if(this.fillPassport(t,a,s))return;break;case be.RewardsProgram:if(this.fillRewardsProgram(t,a,s))return;break;case be.SocialSecurityNumber:if(this.fillSSN(t,a,s))return}}if("email"===r){const{email_address:e,provider:i}=t.value.email;return this.processKvp(s,o,e,l.f.Text),void this.processKvp(s,"provider",i,l.f.Text)}if("password"===t.title&&null!=s.passwordHistory&&s.passwordHistory.some((e=>e.password===a)))return;t.guarded&&s.reprompt===b.N.None&&(s.reprompt=b.N.Password);const c="concealed"===r?l.f.Hidden:l.f.Text;this.processKvp(s,o,a,c)}))}getFieldName(e,t){return this.isNullOrWhitespace(t)?e:e.length>25&&RegExp(/[0-9]{2}[A-Z]{2}/,"i").test(e)?t:e}extractValue(e,t){return"date"===t?new Date(1e3*e.date).toUTCString():"monthYear"===t?e.monthYear.toString():e[t]}fillLogin(e,t,s){const i=this.getFieldName(e.id,e.title);return this.isNullOrWhitespace(s.login.username)&&"username"===i?(s.login.username=t,!0):this.isNullOrWhitespace(s.login.password)&&"password"===i?(s.login.password=t,!0):!(!this.isNullOrWhitespace(s.login.totp)||null==e.id||!e.id.startsWith("TOTP_"))&&(s.login.totp=t,!0)}fillApiCredentials(e,t,s){const i=this.getFieldName(e.id,e.title);return this.isNullOrWhitespace(s.login.password)&&"credential"===i?(s.login.password=t,!0):!(!this.isNullOrWhitespace(s.login.uri)||"hostname"!==i)&&(s.login.uris=this.makeUriArray(t),!0)}fillCreditCard(e,t,s){if(this.isNullOrWhitespace(s.card.number)&&"ccnum"===e.id)return s.card.number=t,s.card.brand=this.getCardBrand(t),!0;if(this.isNullOrWhitespace(s.card.code)&&"cvv"===e.id)return s.card.code=t,!0;if(this.isNullOrWhitespace(s.card.cardholderName)&&"cardholder"===e.id)return s.card.cardholderName=t,!0;if(this.isNullOrWhitespace(s.card.expiration)&&"expiry"===e.id){const e=t.toString().trim();return s.card.expMonth=e.substring(4,6),"0"===s.card.expMonth[0]&&(s.card.expMonth=s.card.expMonth.substring(1,2)),s.card.expYear=e.substring(0,4),!0}return"type"===e.id}fillBankAccount(e,t,s){return!(!this.isNullOrWhitespace(s.card.cardholderName)||"owner"!==e.id)&&(s.card.cardholderName=t,!0)}fillIdentity(e,t,s,i){if(this.isNullOrWhitespace(s.identity.firstName)&&"firstname"===e.id)return s.identity.firstName=t,!0;if(this.isNullOrWhitespace(s.identity.lastName)&&"lastname"===e.id)return s.identity.lastName=t,!0;if(this.isNullOrWhitespace(s.identity.middleName)&&"initial"===e.id)return s.identity.middleName=t,!0;if(this.isNullOrWhitespace(s.identity.phone)&&"defphone"===e.id)return s.identity.phone=t,!0;if(this.isNullOrWhitespace(s.identity.company)&&"company"===e.id)return s.identity.company=t,!0;if(this.isNullOrWhitespace(s.identity.email)){if("email"===i){const{email_address:t,provider:i}=e.value.email;return s.identity.email=this.getValueOrDefault(t),this.processKvp(s,"provider",i,l.f.Text),!0}if("email"===e.id)return s.identity.email=t,!0}return!(!this.isNullOrWhitespace(s.identity.username)||"username"!==e.id)&&(s.identity.username=t,!0)}fillDriversLicense(e,t,s){return this.isNullOrWhitespace(s.identity.firstName)&&"fullname"===e.id?(this.processFullName(s,t),!0):this.isNullOrWhitespace(s.identity.address1)&&"address"===e.id?(s.identity.address1=t,!0):this.isNullOrWhitespace(s.identity.country)&&"country"===e.id?(s.identity.country=t,!0):this.isNullOrWhitespace(s.identity.state)&&"state"===e.id?(s.identity.state=t,!0):!(!this.isNullOrWhitespace(s.identity.licenseNumber)||"number"!==e.id)&&(s.identity.licenseNumber=t,!0)}fillOutdoorLicense(e,t,s){return this.isNullOrWhitespace(s.identity.firstName)&&"name"===e.id?(this.processFullName(s,t),!0):this.isNullOrWhitespace(s.identity.country)&&"country"===e.id?(s.identity.country=t,!0):!(!this.isNullOrWhitespace(s.identity.state)||"state"!==e.id)&&(s.identity.state=t,!0)}fillMembership(e,t,s){return this.isNullOrWhitespace(s.identity.firstName)&&"member_name"===e.id?(this.processFullName(s,t),!0):this.isNullOrWhitespace(s.identity.company)&&"org_name"===e.id?(s.identity.company=t,!0):!(!this.isNullOrWhitespace(s.identity.phone)||"phone"!==e.id)&&(s.identity.phone=t,!0)}fillPassport(e,t,s){return this.isNullOrWhitespace(s.identity.firstName)&&"fullname"===e.id?(this.processFullName(s,t),!0):this.isNullOrWhitespace(s.identity.country)&&"issuing_country"===e.id?(s.identity.country=t,!0):!(!this.isNullOrWhitespace(s.identity.passportNumber)||"number"!==e.id)&&(s.identity.passportNumber=t,!0)}fillRewardsProgram(e,t,s){return this.isNullOrWhitespace(s.identity.firstName)&&"member_name"===e.id?(this.processFullName(s,t),!0):!(!this.isNullOrWhitespace(s.identity.company)||"company_name"!==e.id)&&(s.identity.company=t,!0)}fillSSN(e,t,s){return this.isNullOrWhitespace(s.identity.firstName)&&"name"===e.id?(this.processFullName(s,t),!0):!(!this.isNullOrWhitespace(s.identity.ssn)||"number"!==e.id)&&(s.identity.ssn=t,!0)}parsePasswordHistory(e,t){if(null==e||0===e.length)return;const s=e.length>5?5:e.length;t.passwordHistory=e.filter((e=>!this.isNullOrWhitespace(e.value)&&null!=e.time)).sort(((e,t)=>t.time-e.time)).slice(0,s).map((e=>{const t=new _e.i;return t.password=e.value,t.lastUsedDate=new Date((""+e.time).length>=13?e.time:1e3*e.time),t}))}}class Ve{constructor(e,t,s){this.importRecord=e,this.property=t,this.cipher=s,this.lowerProperty=t.toLowerCase()}}const Se=["ainfo","autosubmit","notesplain","ps","scope","tags","title","uuid","notes"];class ke extends w{constructor(){super(...arguments),this.loginPropertyParsers=[this.setLoginUsername,this.setLoginPassword,this.setLoginUris],this.creditCardPropertyParsers=[this.setCreditCardNumber,this.setCreditCardVerification,this.setCreditCardCardholderName,this.setCreditCardExpiry],this.identityPropertyParsers=[this.setIdentityFirstName,this.setIdentityInitial,this.setIdentityLastName,this.setIdentityUserName,this.setIdentityEmail,this.setIdentityPhone,this.setIdentityCompany]}parse(e){const t=new o,s=this.parseCsv(e,!0,{quoteChar:'"',escapeChar:"\\"});return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(this.isNullOrWhitespace(this.getProp(e,"title")))return;const s=this.initLoginCipher();s.name=this.getValueOrDefault(this.getProp(e,"title"),"--"),this.setNotes(e,s),this.setCipherType(e,s);let r=null;for(const t in e){if(!e.hasOwnProperty(t)||this.isNullOrWhitespace(e[t]))continue;const n=new Ve(e,t,s);s.type===i.O.Login&&this.setKnownLoginValue(n)||(s.type===i.O.Card&&this.setKnownCreditCardValue(n)||s.type===i.O.Identity&&this.setKnownIdentityValue(n)||(r=this.setUnknownValue(n,r)))}s.type===i.O.Login&&!this.isNullOrWhitespace(r)&&this.isNullOrWhitespace(s.login.username)&&-1===r.indexOf("://")&&(s.login.username=r),this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}getProp(e,t){return Object.entries(e).reduce(((e,t)=>(e[t[0].toLowerCase()]=t[1],e)),{})[t.toLowerCase()]}getPropByRegexp(e,t){const s=Object.keys(e).reduce(((e,s)=>(s.match(t)&&e.push(s),e)),[]);return 0===s.length?null:e[s[0]]}getPropIncluding(e,t){const s=Object.keys(e).reduce(((e,s)=>(s.toLowerCase().includes(t.toLowerCase())&&e.push(s),e)),[]);return 0===s.length?null:e[s[0]]}setNotes(e,t){t.notes=this.getValueOrDefault(this.getProp(e,"notesPlain"),"")+"\n"+this.getValueOrDefault(this.getProp(e,"notes"),"")+"\n",t.notes.trim()}setKnownLoginValue(e){return this.loginPropertyParsers.reduce(((t,s)=>(t||(t=s.bind(this)(e)),t)),!1)}setKnownCreditCardValue(e){return this.creditCardPropertyParsers.reduce(((t,s)=>(t||(t=s.bind(this)(e)),t)),!1)}setKnownIdentityValue(e){return this.identityPropertyParsers.reduce(((t,s)=>(t||(t=s.bind(this)(e)),t)),!1)}setUnknownValue(e,t){if(-1===Se.indexOf(e.lowerProperty)&&!e.lowerProperty.startsWith("section:")&&!e.lowerProperty.startsWith("section ")){if(null==t&&"email"===e.lowerProperty)return e.importRecord[e.property];if("created date"===e.lowerProperty||"modified date"===e.lowerProperty){const t=new Date(1e3*parseInt(e.importRecord[e.property],10)).toUTCString();return this.processKvp(e.cipher,"1Password "+e.property,t),null}e.lowerProperty.includes("password")||e.lowerProperty.includes("key")||e.lowerProperty.includes("secret")?this.processKvp(e.cipher,e.property,e.importRecord[e.property],l.f.Hidden):this.processKvp(e.cipher,e.property,e.importRecord[e.property])}return null}setIdentityFirstName(e){return!(!this.isNullOrWhitespace(e.cipher.identity.firstName)||!e.lowerProperty.includes("first name"))&&(e.cipher.identity.firstName=e.importRecord[e.property],!0)}setIdentityInitial(e){return!(!this.isNullOrWhitespace(e.cipher.identity.middleName)||!e.lowerProperty.includes("initial"))&&(e.cipher.identity.middleName=e.importRecord[e.property],!0)}setIdentityLastName(e){return!(!this.isNullOrWhitespace(e.cipher.identity.lastName)||!e.lowerProperty.includes("last name"))&&(e.cipher.identity.lastName=e.importRecord[e.property],!0)}setIdentityUserName(e){return!(!this.isNullOrWhitespace(e.cipher.identity.username)||!e.lowerProperty.includes("username"))&&(e.cipher.identity.username=e.importRecord[e.property],!0)}setIdentityCompany(e){return!(!this.isNullOrWhitespace(e.cipher.identity.company)||!e.lowerProperty.includes("company"))&&(e.cipher.identity.company=e.importRecord[e.property],!0)}setIdentityPhone(e){return!(!this.isNullOrWhitespace(e.cipher.identity.phone)||!e.lowerProperty.includes("default phone"))&&(e.cipher.identity.phone=e.importRecord[e.property],!0)}setIdentityEmail(e){return!(!this.isNullOrWhitespace(e.cipher.identity.email)||!e.lowerProperty.includes("email"))&&(e.cipher.identity.email=e.importRecord[e.property],!0)}setCreditCardNumber(e){return!(!this.isNullOrWhitespace(e.cipher.card.number)||!e.lowerProperty.includes("number"))&&(e.cipher.card.number=e.importRecord[e.property],e.cipher.card.brand=this.getCardBrand(e.cipher.card.number),!0)}setCreditCardVerification(e){return!(!this.isNullOrWhitespace(e.cipher.card.code)||!e.lowerProperty.includes("verification number"))&&(e.cipher.card.code=e.importRecord[e.property],!0)}setCreditCardCardholderName(e){return!(!this.isNullOrWhitespace(e.cipher.card.cardholderName)||!e.lowerProperty.includes("cardholder name"))&&(e.cipher.card.cardholderName=e.importRecord[e.property],!0)}setCreditCardExpiry(e){return!(!this.isNullOrWhitespace(e.cipher.card.expiration)||!e.lowerProperty.includes("expiry date")||7!==e.importRecord[e.property].length)&&(e.cipher.card.expMonth=e.importRecord[e.property].substr(0,2),"0"===e.cipher.card.expMonth[0]&&(e.cipher.card.expMonth=e.cipher.card.expMonth.substr(1,1)),e.cipher.card.expYear=e.importRecord[e.property].substr(3,4),!0)}setLoginPassword(e){return!(!this.isNullOrWhitespace(e.cipher.login.password)||"password"!==e.lowerProperty)&&(e.cipher.login.password=e.importRecord[e.property],!0)}setLoginUsername(e){return!(!this.isNullOrWhitespace(e.cipher.login.username)||"username"!==e.lowerProperty)&&(e.cipher.login.username=e.importRecord[e.property],!0)}setLoginUris(e){if((null==e.cipher.login.uris||0===e.cipher.login.uris.length)&&"urls"===e.lowerProperty){const t=e.importRecord[e.property].split(this.newLineRegex);return e.cipher.login.uris=this.makeUriArray(t),!0}return"url"===e.lowerProperty&&(null==e.cipher.login.uris&&(e.cipher.login.uris=[]),e.cipher.login.uris.concat(this.makeUriArray(e.importRecord[e.property])),!0)}}class Ee extends ke{setCipherType(e,t){switch(this.getValueOrDefault(this.getProp(e,"type"),"Login")){case"Credit Card":t.type=i.O.Card,t.card=new R._,Se.push("type");break;case"Identity":t.type=i.O.Identity,t.identity=new M.t,Se.push("type");break;case"Login":case"Secure Note":Se.push("type")}}}class Ae extends ke{constructor(){super(),this.identityPropertyParsers.push(this.setIdentityAddress)}setCipherType(e,t){t.type=i.O.Login,t.login=new g.q,this.isNullOrWhitespace(this.getPropByRegexp(e,/\d+: number/i))||this.isNullOrWhitespace(this.getPropByRegexp(e,/\d+: expiry date/i))||(t.type=i.O.Card,t.card=new R._),this.isNullOrWhitespace(this.getPropByRegexp(e,/name \d+: first name/i))&&this.isNullOrWhitespace(this.getPropByRegexp(e,/name \d+: initial/i))&&this.isNullOrWhitespace(this.getPropByRegexp(e,/name \d+: last name/i))&&this.isNullOrWhitespace(this.getPropByRegexp(e,/internet \d+: email/i))||(t.type=i.O.Identity,t.identity=new M.t)}setIdentityAddress(e){return!!e.lowerProperty.match(/address \d+: address/i)&&(this.processKvp(e.cipher,"address",e.importRecord[e.property]),!0)}setCreditCardExpiry(e){if(this.isNullOrWhitespace(e.cipher.card.expiration)&&e.lowerProperty.includes("expiry date")){const t=e.importRecord[e.property].split("/");return e.cipher.card.expMonth=t[0],"0"===e.cipher.card.expMonth[0]&&2===e.cipher.card.expMonth.length&&(e.cipher.card.expMonth=e.cipher.card.expMonth.substr(1,1)),e.cipher.card.expYear=t[2].length>4?t[2].substr(0,4):t[2],!0}return!1}}class Te extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);if(null==s)return t.success=!1,Promise.resolve(t);let i=null;return s.forEach((e=>{if(null==i)return void(i=e.map((e=>e)));if(e.length<2||e.length!==i.length)return;if(!this.isNullOrWhitespace(e[1]))if(this.organization){e[1].split(",").forEach((e=>{e=e.trim();let s=!0,i=t.collections.length;for(let r=0;r<t.collections.length;r++)if(t.collections[r].name===e){s=!1,i=r;break}if(s){const s=new h.n;s.name=e,t.collections.push(s)}t.collectionRelationships.push([t.ciphers.length,i])}))}else{const s=e[1].split(","),i=s.length>0?s[0].trim():null;this.processFolder(t,i)}const s=this.initLoginCipher();s.name=this.getValueOrDefault(e[0],"--");for(let t=2;t<e.length;t++){const r=i[t].trim().toLowerCase();this.isNullOrWhitespace(e[t])||this.isNullOrWhitespace(r)||(this.usernameFieldNames.indexOf(r)>-1?s.login.username=e[t]:this.passwordFieldNames.indexOf(r)>-1?s.login.password=e[t]:this.uriFieldNames.indexOf(r)>-1?s.login.uris=this.makeUriArray(e[t]):this.processKvp(s,i[t],e[t]))}this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t)}}class Ie extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{this.processFolder(t,this.getValue("category",e));const s=this.initLoginCipher();s.notes=this.getValue("description",e),s.name=this.getValueOrDefault(this.getValue("title",e),"--"),s.login.username=this.getValue("username",e),s.login.password=this.getValue("password",e),s.login.uris=this.makeUriArray(this.getValue("site",e)),this.processKvp(s,"Password 2",this.getValue("password2",e)),this.cleanupCipher(s),t.ciphers.push(s)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}getValue(e,t){return this.getValueOrDefault(t[e],this.getValueOrDefault(t[" "+e]))}}class Fe extends w{parse(e){const t=new o,s=JSON.parse(e);return null==s||0===s.length?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(null!=e.tags&&e.tags.length>0){const s=e.tags[0].text;this.processFolder(t,s)}const s=this.initLoginCipher();s.name=e.label,s.login.username=this.getValueOrDefault(e.username),this.isNullOrWhitespace(s.login.username)?s.login.username=this.getValueOrDefault(e.email):this.isNullOrWhitespace(e.email)||(s.notes="Email: "+e.email+"\n"),s.login.password=this.getValueOrDefault(e.password),s.login.uris=this.makeUriArray(e.url),s.notes+=this.getValueOrDefault(e.description,""),null!=e.otp&&(s.login.totp=this.getValueOrDefault(e.otp.secret)),null!=e.custom_fields&&e.custom_fields.forEach((e=>{switch(e.field_type){case"text":case"password":this.processKvp(s,e.label,e.value)}})),this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}}class Le extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.isNullOrWhitespace(e.Tags)?null:JSON.parse(e.Tags),i=null!=s&&null!=s.tags&&s.tags.length>0?s.tags.map((e=>{try{const t=JSON.parse(e);return this.getValueOrDefault(t.tag)}catch(t){}return null})).filter((e=>!this.isNullOrWhitespace(e))):null;this.organization&&null!=i&&i.length>0?i.forEach((e=>{let s=!0,i=t.collections.length;for(let r=0;r<t.collections.length;r++)if(t.collections[r].name===e){s=!1,i=r;break}if(s){const s=new h.n;s.name=e,t.collections.push(s)}t.collectionRelationships.push([t.ciphers.length,i])})):!this.organization&&null!=i&&i.length>0&&this.processFolder(t,i[0]);const r=this.initLoginCipher();r.notes=this.getValueOrDefault(e.Notes,""),r.notes+="\n\n"+this.getValueOrDefault(e["Shared Notes"],"")+"\n",r.name=this.getValueOrDefault(e["Entry Name"],"--"),r.login.username=this.getValueOrDefault(e["User ID"]),r.login.password=this.getValueOrDefault(e.Password),r.login.uris=this.makeUriArray(e.URL),null!=e.__parsed_extra&&e.__parsed_extra.length>0&&e.__parsed_extra.forEach((e=>{this.isNullOrWhitespace(e)||(r.notes+="\n"+e)}));const n=this.isNullOrWhitespace(e["Extra Fields"])?null:JSON.parse(e["Extra Fields"]),o=null!=n&&null!=n.extraFields&&n.extraFields.length>0?n.extraFields.map((e=>{try{return JSON.parse(e)}catch(t){}return null})):null;null!=o&&o.forEach((e=>{null!=e&&this.processKvp(r,e.name,e.data)})),this.cleanupCipher(r),t.ciphers.push(r)})),t.success=!0,Promise.resolve(t))}}class We extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);if(null==s)return t.success=!1,Promise.resolve(t);let i=!0;return s.forEach((e=>{if(5!==e.length&&e.length<9)return;const s=10===e.length&&"0"===e[0],r=this.initLoginCipher();if(r.name=this.getValueOrDefault(e[s?1:0],"--"),r.login.username=this.getValueOrDefault(e[s?2:1]),r.login.password=this.getValueOrDefault(e[s?3:2]),5===e.length)i=!1,r.notes=this.getValueOrDefault(e[4]),r.login.uris=this.makeUriArray(e[3]);else{const i=this.getValueOrDefault(e[s?9:8],"(None)");let n="(None)"!==i?i.split("\\").join("/"):null;null!=n&&(n=i.split(" > ").join("/"),n=i.split(">").join("/")),this.processFolder(t,n),r.notes=this.getValueOrDefault(e[s?5:3]),r.login.uris=this.makeUriArray(e[4])}this.convertToNoteIfNeeded(r),this.cleanupCipher(r),t.ciphers.push(r)})),i&&this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t)}}class Ze extends w{parse(e){const t=new o,s=JSON.parse(e);if(null==s||null==s.items)return t.success=!1,Promise.resolve(t);const r=new Map;s.folders.forEach((e=>{r.set(e.id,e.name)}));const n=new Map;return r.forEach(((e,s)=>{n.set(s,t.folders.length);const i=new m.a;i.name=e,t.folders.push(i)})),s.items.forEach((e=>{const s=this.initLoginCipher();if(s.name=this.getValueOrDefault(e.name,"--"),s.login.uris=this.makeUriArray(e.login_url),null!=e.folder&&n.has(e.folder)&&t.folderRelationships.push([t.ciphers.length,n.get(e.folder)]),null!=e.identifiers){this.isNullOrWhitespace(e.identifiers.notes)||(s.notes=e.identifiers.notes.split("\\r\\n").join("\n").split("\\n").join("\n")),"CreditCard"===e.type&&(s.card=new R._,s.type=i.O.Card);for(const t in e.identifiers){if(!e.identifiers.hasOwnProperty(t))continue;const n=e.identifiers[t],o=null!=n?n.toString():null;if(!this.isNullOrWhitespace(o)&&"notes"!==t&&"ignoreItemInSecurityScore"!==t)if("custom_fields"!==t){if(s.type===i.O.Card){if("cardNumber"===t){s.card.number=o,s.card.brand=this.getCardBrand(o);continue}if("nameOnCard"===t){s.card.cardholderName=o;continue}if("security_code"===t){s.card.code=o;continue}if("expires"===t){try{const e=new Date(o);s.card.expYear=e.getFullYear().toString(),s.card.expMonth=(e.getMonth()+1).toString()}catch(r){}continue}if("cardType"===t)continue}else{if(("username"===t||"email"===t)&&this.isNullOrWhitespace(s.login.username)){s.login.username=o;continue}if("password"===t){s.login.password=o;continue}if("totp"===t){s.login.totp=o;continue}if((null==s.login.uris||0===s.login.uris.length)&&this.uriFieldNames.indexOf(t)>-1){s.login.uris=this.makeUriArray(o);continue}}this.processKvp(s,t,o)}else n.forEach((e=>{this.processKvp(s,e.name,e.value)}))}this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)}})),t.success=!0,Promise.resolve(t)}}class qe extends w{parse(e){const t=new o,s=this.parseXml(e);if(null==s)return t.success=!1,Promise.resolve(t);const i=s.querySelectorAll("PasswordManager > record");return Array.from(i).forEach((e=>{const s=this.querySelectorDirectChild(e,"Category"),i=null==s||this.isNullOrWhitespace(s.textContent)||"Unfiled"===s.textContent?null:s.textContent;this.processFolder(t,i);const r=this.querySelectorDirectChild(e,"Account-Name"),n=this.querySelectorDirectChild(e,"User-Id"),o=this.querySelectorDirectChild(e,"Password"),a=this.querySelectorDirectChild(e,"URL"),l=this.querySelectorDirectChild(e,"Notes"),c=this.initLoginCipher();c.name=null!=r?this.getValueOrDefault(r.textContent,"--"):"--",c.notes=null!=l?this.getValueOrDefault(l.textContent):"",c.login.username=null!=n?this.getValueOrDefault(n.textContent):null,c.login.password=null!=o?this.getValueOrDefault(o.textContent):null,c.login.uris=null!=a?this.makeUriArray(a.textContent):null;const u=[];for(let t=1;t<=10;t++)u.push("Attribute-"+t);this.querySelectorAllDirectChild(e,u.join(",")).forEach((e=>{this.isNullOrWhitespace(e.textContent)||"null"===e.textContent||this.processKvp(c,e.tagName,e.textContent)})),this.cleanupCipher(c),t.ciphers.push(c)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t)}}class Be extends w{parse(e){const t=new o,s=this.parseXml(e);if(null==s)return t.success=!1,Promise.resolve(t);const i=s.querySelector("passwordsafe");if(null==i)return t.errorMessage="Missing `passwordsafe` node.",t.success=!1,Promise.resolve(t);const r=i.getAttribute("delimiter"),n=s.querySelectorAll("passwordsafe > entry");return Array.from(n).forEach((e=>{const s=this.querySelectorDirectChild(e,"group"),i=null==s||this.isNullOrWhitespace(s.textContent)?null:s.textContent.split(".").join("/");this.processFolder(t,i);const n=this.querySelectorDirectChild(e,"title"),o=this.querySelectorDirectChild(e,"username"),a=this.querySelectorDirectChild(e,"email"),l=this.querySelectorDirectChild(e,"password"),c=this.querySelectorDirectChild(e,"url"),u=this.querySelectorDirectChild(e,"notes"),p=this.initLoginCipher();p.name=null!=n?this.getValueOrDefault(n.textContent,"--"):"--",p.notes=null!=u?this.getValueOrDefault(u.textContent,"").split(r).join("\n"):null,p.login.username=null!=o?this.getValueOrDefault(o.textContent):null,p.login.password=null!=l?this.getValueOrDefault(l.textContent):null,p.login.uris=null!=c?this.makeUriArray(c.textContent):null,this.isNullOrWhitespace(p.login.username)&&null!=a?p.login.username=this.getValueOrDefault(a.textContent):null==a||this.isNullOrWhitespace(a.textContent)||(p.notes=this.isNullOrWhitespace(p.notes)?"Email: "+a.textContent:p.notes+"\nEmail: "+a.textContent),this.cleanupCipher(p),t.ciphers.push(p)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t)}}class Re extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(e.length<1)return;e.length>5&&this.processFolder(t,e[5]);const s=this.initLoginCipher();s.name=this.getValueOrDefault(e[0],"--"),e.length>4&&(s.notes=this.getValueOrDefault(e[4],"").split("¬").join("\n")),e.length>2&&(s.login.username=this.getValueOrDefault(e[2])),e.length>3&&(s.login.password=this.getValueOrDefault(e[3])),e.length>1&&(s.login.uris=this.makeUriArray(e[1])),this.cleanupCipher(s),t.ciphers.push(s)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}}class Me extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if("true"===e.trash)return;const s=this.initLoginCipher();if(s.name=this.getValueOrDefault(e.name),s.notes=this.getValueOrDefault(e.notes),"LoginItem"===e.type)s.login.uris=this.makeUriArray(e.website),s.login.password=this.getValueOrDefault(e.password),s.login.username=this.getValueOrDefault(e.username);else if("CreditCardItem"===e.type){s.type=i.O.Card,s.card=new R._,s.card.cardholderName=this.getValueOrDefault(e.cardholder),s.card.number=this.getValueOrDefault(e.number),s.card.brand=this.getCardBrand(s.card.number),s.card.code=this.getValueOrDefault(e.verification);try{const t=this.getValueOrDefault(e.expiryMonth);if(null!=t){const e=parseInt(t,null);null!=e&&e>=1&&e<=12&&(s.card.expMonth=e.toString())}}catch(r){}try{const t=this.getValueOrDefault(e.expiryYear);if(null!=t){const e=parseInt(t,null);null!=e&&(s.card.expYear=e.toString())}}catch(n){}const t=this.getValueOrDefault(e.pin);null!=t&&this.processKvp(s,"PIN",t);const o=this.getValueOrDefault(e.zipCode);null!=o&&this.processKvp(s,"Zip Code",o)}this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class Ye extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);if(null==s)return t.success=!1,Promise.resolve(t);let i=1;return s.forEach((e=>{const r=!this.isNullOrWhitespace(e.Folder)&&e.Folder.startsWith("/")?e.Folder.replace("/",""):e.Folder,n=this.isNullOrWhitespace(r)?null:r;this.processFolder(t,n);const o=this.initLoginCipher();if(o.notes=this.getValueOrDefault(e.Note),o.name=this.getValueOrDefault(e.Name,"--"),o.login.username=this.getValueOrDefault(e.Login),o.login.password=this.getValueOrDefault(e.Pwd),o.login.uris=this.makeUriArray(e.Url),!this.isNullOrWhitespace(e.Rf_fields)){let t=[e.Rf_fields];null!=e.__parsed_extra&&e.__parsed_extra.length>0&&(t=t.concat(e.__parsed_extra)),t.forEach((e=>{const t=e.split(":");if(t.length<3)return;const s="-no-name-"===t[0]?null:t[0],i=4===t.length&&"rck"===t[2]?t[1]:t[2];this.processKvp(o,s,i)}))}this.convertToNoteIfNeeded(o),this.cleanupCipher(o),i===s.length&&"--"===o.name&&this.isNullOrWhitespace(o.login.password)||(t.ciphers.push(o),i++)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t)}}class Qe extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{var s;const i=this.initLoginCipher();i.name=this.getValueOrDefault(e.Title,"--"),i.login.username=this.getValueOrDefault(e.Username),i.login.password=this.getValueOrDefault(e.Password),i.login.uris=this.makeUriArray(null!==(s=e.Url)&&void 0!==s?s:e.URL),i.login.totp=this.getValueOrDefault(e.OTPAuth),i.notes=this.getValueOrDefault(e.Notes),this.cleanupCipher(i),t.ciphers.push(i)})),t.success=!0,Promise.resolve(t))}}class Je extends w{parse(e){const t=new o,s=this.parseXml(e);if(null==s)return t.success=!1,Promise.resolve(t);if(null==s.querySelector("database"))return t.errorMessage="Missing `database` node.",t.success=!1,Promise.resolve(t);const r=new Map;return Array.from(s.querySelectorAll("database > label")).forEach((e=>{const s=e.getAttribute("name"),i=e.getAttribute("id");if(!this.isNullOrWhitespace(s)&&!this.isNullOrWhitespace(i)){r.set(i,t.folders.length);const e=new m.a;e.name=s,t.folders.push(e)}})),Array.from(s.querySelectorAll("database > card")).forEach((e=>{if("true"===e.getAttribute("template")||"true"===e.getAttribute("deleted"))return;const s=this.querySelectorDirectChild(e,"label_id");if(null!=s){const e=s.textContent;!this.isNullOrWhitespace(e)&&r.has(e)&&t.folderRelationships.push([t.ciphers.length,r.get(e)])}const n=this.initLoginCipher();n.name=this.getValueOrDefault(e.getAttribute("title"),"--"),"true"===e.getAttribute("star")&&(n.favorite=!0);"note"===e.getAttribute("type")?(n.type=i.O.SecureNote,n.secureNote=new y.z,n.secureNote.type=c.x.Generic):Array.from(this.querySelectorAllDirectChild(e,"field")).forEach((e=>{const t=e.textContent;if(this.isNullOrWhitespace(t))return;const s=e.getAttribute("name"),i=this.getValueOrDefault(e.getAttribute("type"),"").toLowerCase();"login"===i?n.login.username=t:"password"===i||"secret"===i?this.processKvp(n,s,t,l.f.Hidden):"one_time_password"===i?n.login.totp=t:"notes"===i?n.notes+=t+"\n":"weblogin"===i||"website"===i?n.login.uris=this.makeUriArray(t):this.processKvp(n,s,t)})),Array.from(this.querySelectorAllDirectChild(e,"notes")).forEach((e=>{n.notes+=e.textContent+"\n"})),this.setPassword(n),this.cleanupCipher(n),t.ciphers.push(n)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t)}setPassword(e){const t=e.fields.filter((e=>e.type===l.f.Hidden));if(!t.length)return;let s;for(const i of t)if(this.passwordFieldNames.includes(i.name.toLowerCase())){s=i,e.fields=e.fields.filter((e=>e!==s));break}s||(s=t[0]),e.login.password=s.value}}class ze extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(this.nameFromUrl(e.url),"--"),s.notes=this.getValueOrDefault(e.notes),s.login.username=this.getValueOrDefault(e.username),s.login.password=this.getValueOrDefault(e.password),s.login.uris=this.makeUriArray(e.url),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class je extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.Title),s.notes=this.getValueOrDefault(e.Comment),s.login.uris=this.makeUriArray(e.Url),s.login.password=this.getValueOrDefault(e.Password),s.login.username=this.getValueOrDefault(e.Username),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class Ke extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(e.length<3)return;this.processFolder(t,this.getValueOrDefault(e[e.length-1]));const s=this.initLoginCipher();s.notes=this.getValueOrDefault(e[e.length-2],""),s.name=this.getValueOrDefault(e[1],"--"),"Web Logins"===e[0]||"Servers"===e[0]||"Email Accounts"===e[0]?(s.login.username=this.getValueOrDefault(e[2]),s.login.password=this.getValueOrDefault(e[3]),s.login.uris=this.makeUriArray(e[4]),this.parseFieldsToNotes(s,5,e)):this.parseFieldsToNotes(s,2,e),this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}parseFieldsToNotes(e,t,s){for(let i=t;i<s.length-3;i++)this.isNullOrWhitespace(s[i])||(e.notes+=s[i]+"\n")}}class He extends w{parse(e){const t=new o,s=this.parseXml(e);if(null==s)return t.success=!1,Promise.resolve(t);const i=s.querySelectorAll("root > Database > Logins > Login");return Array.from(i).forEach((e=>{const i=e.getAttribute("ID");if(this.isNullOrWhitespace(i))return;const r=e.getAttribute("Name"),n=e.getAttribute("Password");let o=null,a=null,l=null,c=null,u=null;const p=s.querySelector('root > Database > Accounts > Account > LoginLinks > Login[SourceLoginID="'+i+'"]');if(null!=p){const e=p.parentElement.parentElement;null!=e&&(o=e.getAttribute("Name"),a=e.getAttribute("Link"),c=e.getAttribute("ParentID"),l=e.getAttribute("Comments"),this.isNullOrWhitespace(l)||(l=l.split("/n").join("\n")))}this.isNullOrWhitespace(c)||(u=this.buildGroupText(s,c,""),this.processFolder(t,u));const h=this.initLoginCipher();h.name=this.getValueOrDefault(o,"--"),h.notes=this.getValueOrDefault(l),h.login.username=this.getValueOrDefault(r),h.login.password=this.getValueOrDefault(n),h.login.uris=this.makeUriArray(a),this.cleanupCipher(h),t.ciphers.push(h)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t)}buildGroupText(e,t,s){const i=e.querySelector('root > Database > Groups > Group[ID="'+t+'"]');return null==i?s:(this.isNullOrWhitespace(s)||(s="/"+s),s=i.getAttribute("Name")+s,this.buildGroupText(e,i.getAttribute("ParentID"),s))}}const Ge=["kind","autologin","favorite","hexcolor","protectedwithpassword","subdomainonly","type","tk_export_version","note","title","document_content"];class $e extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();if(s.favorite="true"===this.getValueOrDefault(e.favorite,"").toLowerCase(),s.name=this.getValueOrDefault(e.name,"--"),s.notes=this.getValueOrDefault(e.memo,""),s.login.username=this.getValueOrDefault(e.login),s.login.password=this.getValueOrDefault(e.password),s.login.uris=this.makeUriArray(e.url),"login"!==e.kind&&(s.name=this.getValueOrDefault(e.title,"--"),s.notes=this.getValueOrDefault(e.note,"")),"cc"===e.kind){if(s.type=i.O.Card,s.card=new R._,s.card.cardholderName=this.getValueOrDefault(e.cardholder),s.card.number=this.getValueOrDefault(e.number),s.card.brand=this.getCardBrand(s.card.number),!this.isNullOrWhitespace(e.expiryDate))try{const t=new Date(e.expiryDate);s.card.expYear=t.getFullYear().toString(),s.card.expMonth=(t.getMonth()+1).toString()}catch(r){}}else if("login"!==e.kind){s.type=i.O.SecureNote,s.secureNote=new y.z,s.secureNote.type=c.x.Generic,this.isNullOrWhitespace(s.notes)||(s.notes=this.getValueOrDefault(e.document_content,""));for(const t in e)e.hasOwnProperty(t)&&Ge.indexOf(t.toLowerCase())<0&&!this.isNullOrWhitespace(e[t])&&this.processKvp(s,t,e[t])}this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class Xe extends w{parse(e){const t=new o,s=this.parseCsv(e,!1);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(5!==e.length)return;const s=this.initLoginCipher();s.name=this.getValueOrDefault(e[0],"--"),s.notes=this.getValueOrDefault(e[4]),s.login.username=this.getValueOrDefault(e[1]),s.login.password=this.getValueOrDefault(e[2]),s.login.uris=this.makeUriArray(e[3]),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class et extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{const s=this.initLoginCipher();s.name=this.getValueOrDefault(e.Name,"--"),s.login.username=this.getValueOrDefault(e["User name"]),s.login.password=this.getValueOrDefault(e.Password),s.login.uris=this.makeUriArray(e.URL),this.cleanupCipher(s),t.ciphers.push(s)})),t.success=!0,Promise.resolve(t))}}class tt extends w{parse(e){const t=new o,s=this.parseCsv(e,!0);return null==s?(t.success=!1,Promise.resolve(t)):(s.forEach((e=>{if(this.isNullOrWhitespace(e["Password Name"])&&this.isNullOrWhitespace(e["Secret Name"]))return;this.processFolder(t,this.getValueOrDefault(e.ChamberName));const s=this.initLoginCipher();s.favorite="1"===this.getValueOrDefault(e.Favorite,"0"),s.notes=this.getValueOrDefault(e.Notes),s.name=this.getValueOrDefault(e["Password Name"],this.getValueOrDefault(e["Secret Name"],"--")),s.login.uris=this.makeUriArray(this.getValueOrDefault(e["Password URL"],this.getValueOrDefault(e["Secret URL"]))),this.parseData(s,e.SecretData),this.parseData(s,e.CustomData),this.convertToNoteIfNeeded(s),this.cleanupCipher(s),t.ciphers.push(s)})),this.organization&&this.moveFoldersToCollections(t),t.success=!0,Promise.resolve(t))}parseData(e,t){if(this.isNullOrWhitespace(t))return;this.splitNewLine(t).forEach((t=>{const s=t.indexOf(":");if(s<0)return;const i=t.substring(0,s),r=t.length>s?t.substring(s+1):null;if(this.isNullOrWhitespace(i)||this.isNullOrWhitespace(r)||"SecretType"===i)return;const n=i.toLowerCase();null==e.login.username&&this.usernameFieldNames.indexOf(n)>-1?e.login.username=r:null==e.login.password&&this.passwordFieldNames.indexOf(n)>-1?e.login.password=r:this.processKvp(e,i,r)}))}}var st=s(1937),it=s(20537),rt=s(45733);class nt{constructor(){this.ciphers=[],this.folders=[],this.folderRelationships=[]}}class ot{constructor(){this.ciphers=[],this.collections=[],this.collectionRelationships=[]}}class at{constructor(e,t){this.key=e,this.value=t}}var lt=s(93638),ct=function(e,t,s,i){return new(s||(s=Promise))((function(r,n){function o(e){try{l(i.next(e))}catch(t){n(t)}}function a(e){try{l(i.throw(e))}catch(t){n(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))};class ut{constructor(e,t,s,i,o,a){this.cipherService=e,this.folderService=t,this.apiService=s,this.i18nService=i,this.collectionService=o,this.cryptoService=a,this.featuredImportOptions=r,this.regularImportOptions=n}getImportOptions(){return this.featuredImportOptions.concat(this.regularImportOptions)}import(e,t,s=null){return ct(this,void 0,void 0,(function*(){const i=yield e.parse(t);if(i.success){if(0===i.folders.length&&0===i.ciphers.length)return new se(this.i18nService.t("importNothingError"));if(i.ciphers.length>0){const e=Math.floor(i.ciphers.length/2),t=i.ciphers.length-1;if(this.badData(i.ciphers[0])&&this.badData(i.ciphers[e])&&this.badData(i.ciphers[t]))return new se(this.i18nService.t("importFormatError"))}try{yield this.postImport(i,s)}catch(r){const e=new lt.i(r,400);return this.handleServerError(e,i)}return null}return u.c.isNullOrWhitespace(i.errorMessage)?new se(this.i18nService.t("importFormatError"),i.missingPassword):new se(i.errorMessage,i.missingPassword)}))}getImporter(e,t=null,s=null){const i=this.getImporterInstance(e,s);return null==i?null:(i.organizationId=t,i)}getImporterInstance(e,t){if(null==e)return null;switch(e){case"bitwardencsv":return new U;case"bitwardenjson":return new k(this.cryptoService,this.i18nService);case"bitwardenpasswordprotected":return new T(this.cryptoService,this.i18nService,t);case"lastpasscsv":case"passboltcsv":return new pe;case"keepassxcsv":return new ce;case"aviracsv":return new C;case"blurcsv":return new F;case"safeincloudxml":return new Je;case"padlockcsv":return new Te;case"keepass2xml":return new le;case"chromecsv":case"operacsv":case"vivaldicsv":return new Z;case"firefoxcsv":return new X;case"upmcsv":return new Xe;case"saferpasscsv":return new ze;case"safaricsv":return new Qe;case"meldiumcsv":return new de;case"1password1pif":return new De;case"1password1pux":return new Pe;case"1passwordwincsv":return new Ae;case"1passwordmaccsv":return new Ee;case"keepercsv":return new ue;case"passworddragonxml":return new qe;case"enpasscsv":return new G;case"enpassjson":return new $;case"pwsafexml":return new Be;case"dashlanecsv":return new z;case"dashlanejson":return new K;case"msecurecsv":return new me;case"stickypasswordxml":return new He;case"truekeycsv":return new $e;case"clipperzhtml":return new q;case"roboformcsv":return new Ye;case"ascendocsv":return new O;case"passwordbossjson":return new Ze;case"zohovaultcsv":return new tt;case"splashidcsv":return new Ke;case"passkeepcsv":return new Ie;case"gnomejson":return new te;case"passwordagentcsv":return new We;case"passpackcsv":return new Le;case"passmanjson":return new Fe;case"avastcsv":return new x;case"avastjson":return new N;case"fsecurefsk":return new ee;case"kasperskytxt":return new ae;case"remembearcsv":return new Me;case"passwordwallettxt":return new Re;case"mykicsv":return new Ne;case"securesafecsv":return new je;case"logmeoncecsv":return new he;case"blackberrycsv":return new I;case"buttercupcsv":return new W;case"codebookcsv":return new B;case"encryptrcsv":return new H;case"yoticsv":return new et;case"nordpasscsv":return new Ce;default:return null}}postImport(e,t=null){return ct(this,void 0,void 0,(function*(){if(null==t){const t=new nt;for(let s=0;s<e.ciphers.length;s++){const i=yield this.cipherService.encrypt(e.ciphers[s]);t.ciphers.push(new st.a(i))}if(null!=e.folders)for(let s=0;s<e.folders.length;s++){const i=yield this.folderService.encrypt(e.folders[s]);t.folders.push(new rt.i(i))}return null!=e.folderRelationships&&e.folderRelationships.forEach((e=>t.folderRelationships.push(new at(e[0],e[1])))),yield this.apiService.postImportCiphers(t)}{const s=new ot;for(let i=0;i<e.ciphers.length;i++){e.ciphers[i].organizationId=t;const r=yield this.cipherService.encrypt(e.ciphers[i]);s.ciphers.push(new st.a(r))}if(null!=e.collections)for(let i=0;i<e.collections.length;i++){e.collections[i].organizationId=t;const r=yield this.collectionService.encrypt(e.collections[i]);s.collections.push(new it.W(r))}return null!=e.collectionRelationships&&e.collectionRelationships.forEach((e=>s.collectionRelationships.push(new at(e[0],e[1])))),yield this.apiService.postImportOrganizationCiphers(t,s)}}))}badData(e){return(null==e.name||"--"===e.name)&&e.type===i.O.Login&&null!=e.login&&u.c.isNullOrWhitespace(e.login.password)}handleServerError(e,t){if(null==e.validationErrors)return new se(e.message);let s="";return Object.entries(e.validationErrors).forEach((([e,r],n)=>{let o,a;const l=Number(e.match(/[0-9]+/)[0]);switch(e.match(/^\w+/)[0]){case"Ciphers":o=t.ciphers[l],a=i.O[o.type];break;case"Folders":o=t.folders[l],a="Folder";break;case"Collections":o=t.collections[l],a="Collection";break;default:return}n>0&&(s+="\n\n"),"Folder"!==a&&"Collection"!==a&&(s+="["+(l+1)+"] "),s+="["+a+'] "'+o.name+'": '+r})),new se(s)}}}}]);
//# sourceMappingURL=290.df3b8945ca6bd783424b.js.map